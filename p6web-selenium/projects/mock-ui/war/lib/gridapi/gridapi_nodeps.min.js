/*!
 * Grid api
 * Version 1.2.0
 */

define("gridapi.grid/sorters",["gridapi.underscore"],function(e){return{"float":function(e,t){return t?parseFloat(e):-parseFloat(e)},integer:function(e,t){return t?parseInt(e,10):-parseInt(e,10)},string:function(e,t){return e},date:function(e,t){return e==null?0:t?Date.parse(e):-Date.parse(e)},check:function(e,t){return t?e==="true"?1:0:-(e==="true"?1:0)},"enum":function(e,t){return t?e:-e},picker:function(e,t){return t?e.length:-e.length}}}),define("gridapi.grid/selectionModel",["gridapi.jquery","gridapi.underscore"],function(e,t){return function(n){if(n==null)throw new Error("SelectionModel - grid param not set");var r={recordId:null,column:null,recordIndex:null,wafferId:null,groupId:null,viewport:null,columnIndex:null,$td:e()},i={moveUp:function(){if(r.wafferId!=null){var e="top";if(r.recordIndex>0)r.recordIndex--;else{var t=r.viewport.wafferConfig.prev;if(t==null)return;r.recordIndex=n.virtualRows[t.id].records.length-1,r.wafferId=t.id,r.viewport=n.viewports[t.id][r.groupId],e="bottom";if(t.id==="headers"){n.widget.selectHeaderCell(r.column);return}}r.recordId=n.virtualRows[r.wafferId].records[r.recordIndex],n.widget.selectCell(r.recordId,r.column,e)}},moveDown:function(){if(r.wafferId!=null){var e="bottom";if(r.recordIndex<n.virtualRows[r.wafferId].records.length-1)r.recordIndex++;else{var t=r.viewport.wafferConfig.next;if(t==null)return;r.recordIndex=0,r.wafferId=t.id,r.viewport=n.viewports[t.id][r.groupId],e="top"}r.recordId=n.virtualRows[r.wafferId].records[r.recordIndex],n.widget.selectCell(r.recordId,r.column,e)}},moveLeft:function(){if(r.columnIndex!=null){if(r.columnIndex>0)r.columnIndex--;else{var e=r.viewport.groupConfig.prev;if(e!=null)r.columnIndex=e.columns.length-1,r.groupId=e.id,r.viewport=n.viewports[r.wafferId][r.groupId];else if(r.wafferId!=="headers"&&(r.recordIndex>0||r.viewport.wafferConfig.prev.id!=="headers")){r.groupId=t.last(n.config.groups).id,r.viewport=n.viewports[r.wafferId][r.groupId],r.columnIndex=r.viewport.groupConfig.columns.length-1,r.column=r.viewport.groupConfig.columns[r.columnIndex].dataIndex,this.moveUp();return}}r.column=r.viewport.groupConfig.columns[r.columnIndex].dataIndex,r.wafferId==="headers"?n.widget.selectHeaderCell(r.column):n.widget.selectCell(r.recordId,r.column)}},moveRight:function(){if(r.columnIndex!=null){if(r.columnIndex<r.viewport.groupConfig.columns.length-1)r.columnIndex++;else{var e=r.viewport.groupConfig.next;e!=null?(r.columnIndex=0,r.groupId=e.id,r.viewport=n.viewports[r.wafferId][r.groupId]):r.wafferId!=="headers"&&(r.groupId=t.first(n.config.groups).id,r.viewport=n.viewports[r.wafferId][r.groupId],r.columnIndex=0,r.column=r.viewport.groupConfig.columns[r.columnIndex].dataIndex,this.moveDown())}r.column=r.viewport.groupConfig.columns[r.columnIndex].dataIndex,r.wafferId==="headers"?n.widget.selectHeaderCell(r.column):n.widget.selectCell(r.recordId,r.column)}},firstCellInGrid:function(){r.column=t.first(t.first(n.config.groups).columns).dataIndex,r.recordId=t.first(n.virtualRows[n.config.waffers[1].id].records),n.widget.selectCell(r.recordId,r.column)},lastCellInGrid:function(){r.column=t.last(t.last(n.config.groups).columns).dataIndex,r.recordId=t.last(n.virtualRows[t.last(n.config.waffers).id].records),n.widget.selectCell(r.recordId,r.column)},firstCellInRow:function(){r.column=t.first(t.first(n.config.groups).columns).dataIndex,n.widget.selectCell(r.recordId,r.column)},lastCellInRow:function(){r.column=t.last(r.viewport.groupConfig.columns).dataIndex,n.widget.selectCell(r.recordId,r.column)},cellSelected:function(e,t){e!=null&&e.length&&(this.clear(),e.addClass("cell-selected"),this._updateFocusModel(e),n.closeEditor(),t||n.$grid.get(0).focus(),n.widget.selectCell(r.recordId,r.column))},selectCell:function(e,t){r.$td!=null&&r.$td.length&&r.$td.is(".cell-selected")&&r.$td.removeClass("cell-selected"),this._updateFocusModel(e),r.$td=e,r.$td.addClass("cell-selected"),t||n.$grid.get(0).focus()},selectHeader:function(e,t){r.$td.length&&r.$td.is(".cell-selected")&&r.$td.removeClass("cell-selected"),r.$td=e.find('th[data-index="'+t+['"]']),r.$td.addClass("cell-selected")},_updateFocusModel:function(e){r.column=e.attr("data-index"),r.recordId=e.parent().attr("data-id"),r.viewport=e.closest("div.viewport").data().viewport,r.wafferId=r.viewport.wafferConfig.id,r.groupId=r.viewport.groupConfig.id,r.recordIndex=n.getRecordIndex(r.recordId,r.wafferId);for(var t=0;t<r.viewport.groupConfig.columns.length;t++)if(r.viewport.groupConfig.columns[t].dataIndex===r.column){r.columnIndex=t;break}r.$td=e},clear:function(){n.$grid.find(".cell-selected").removeClass("cell-selected")}},s={get focus(){return r},get cell(){return i},getShiftSelection:function(e){var t=r.wafferId,i=e.closest("div.viewport").data().viewport.waffer,s=[];if(t===i){var o,u,a=r.recordIndex,f=n.getRecordIndex(e.attr("data-id"),i);a>f?(o=f,u=a):(o=a,u=f),s=n.virtualRows[r.wafferId].records.slice(o,u+1)}return s}};return s}}),define("gridapi.grid/columns/core/columnResizeFns",["gridapi.jquery","gridapi.underscore"],function(e,t){return function(t){var n=e('<div class="col-resize-line hidden"></div>'),r=t.options.sizing.minColumnWidth,i=e(),s,o,u,a,f,l={};t.$grid.append(n);var c=function(){return function(t){t.which===1&&p(t.clientX+e(window).scrollLeft())}},h=function(){return function(r){if(r.which===1){t.$grid.off("mousemove"),e(document.body).off("mouseup"),i.parent().removeClass("resize");var s=n.offset().left-o,f=i.closest("table").position().left+a+u,l=s+u-f,c=i.attr("data-index");t.viewports["$group-"+i.closest("div.viewport").data("group")].find('th[data-index="'+c+'"]').attr("width",l),t.columnDefinitions[c].width=l,t.widget._trigger("view-updated",null,{action:"column-resize",column:i.attr("data-index"),size:l}),n.addClass("hidden"),t.resize()}}},p=function(e){f+r<e&&e>=l.left&&e<l.right&&n.css("left",e-s),n.removeClass("hidden")};return{initColumnResize:function(n,r){i=n,i.parent().addClass("resize"),s=t.$grid.offset().left;var d=n.closest("div.viewport");o=d.offset().left,l.left=o+5,l.right=o+d.width()+150,u=parseInt(i.attr("width"),10),a=n.position().left,f=n.offset().left,t.$grid.on("mousemove",c()),e(document.body).on("mouseup",h()),p(r+e(window).scrollLeft())}}}}),define("gridapi.grid/columns/core/columnMover",["gridapi.jquery","gridapi.underscore"],function(e,t){return function(n){var r=n.$grid.find(".col-move-shade"),i=n.$grid.find(".col-move-bar"),s=n.$grid.find(".col-group-drop-shade"),o,u,a=[],f=e(),l,c={},h={},p={shade:{}},d=-1,v,m,g=function(){return function(t){t.which===1&&y(t.clientX+e(window).scrollLeft())}},y=function(e){d=e-c.grid-p.pointer,p.pointer=e-c.grid,x(),m==null&&S()},b=function(){return function(t){t.which===1&&(n.$grid.off("mousemove.col-move"),e(document.body).off("mouseup.col-move"),v!=null&&(clearTimeout(v),v=null),m==null?(w(),n.widget._trigger("view-updated",null,{action:"column-move",column:f.attr("data-index")})):(E(),n.widget._trigger("view-updated",null,{action:"column-drop",column:f.attr("data-index"),viewport:m.group,origin:l.group})),s.hide(),i.hide(),r.hide(),f.removeClass("col-moving"),a=[])}},w=function(){if(u+1!==o&&u!==o){t.each(["thead","tbody","tfoot"],function(r){t.each(n.viewports["$group-"+l.group].find(r).children(),function(t,n){var r=e(t).children(),i=r.eq(u),s=r.eq(o<a.length?o:o-1);o<a.length?s.before(i):s.after(i)})});var r=u>o?o:o-1,i=l.groupConfig.columns.splice(u,1)[0];l.groupConfig.columns.splice(r,0,i)}},E=function(){var r=m.group,i=n.viewports["$group-"+l.group].find("th:eq("+u+")"),s=n.viewports["$group-"+l.group].find("tbody").children().find("td:eq("+u+")"),o=n.viewports["$group-"+l.group].find("tfoot").children().find("td:eq("+u+")");t.each(n.viewports["$group-"+r].find("thead").children(),function(t,n){e(t).append(i.eq(n))}),t.each(n.viewports["$group-"+r].find("tbody").children(),function(t,n){e(t).append(s.eq(n))}),t.each(n.viewports["$group-"+r].find("tfoot").children(),function(t,n){e(t).append(o.eq(n))});var a=l.groupConfig,f=n.viewports[t.first(n.config.waffers).id][r].groupConfig;f.columns.push(a.columns.splice(u,1)[0]),n.resize()},S=function(){p.table=l.$table.position().left,d>0&&o<a.length?p.shade.right>a[o].middle+p.table&&(o++,k()):d<0&&o>0&&p.shade.left<a[o-1].middle+p.table&&(o--,k())},x=function(){v!=null&&(clearTimeout(v),v=null);var e=p.pointer-h.thMiddle,t=0;if(e>c.viewport&&e+h.th<c.viewportRight){r.css("left",e),p.shade.left=e-c.viewport,p.shade.right=p.shade.left+h.th,r.show(),m=null;return}if(p.pointer<c.viewport||p.pointer>c.viewportRight){C();return}s.hide(),m=null,e<c.viewport?(e=c.viewport,t=15):e+h.th>c.viewportRight&&(e=c.viewport+h.viewport-h.th,t=-15),p.shade.left=e-c.viewport,p.shade.right=p.shade.left+h.th,r.css("left",e),r.show(),l.groupConfig.type==="flex"&&t!==0&&(v=setInterval(function(){T(t)},150))},T=function(e){var t=n.pseudoScrollers.horizontal[l.group].$scroller;t.scrollLeft(t.scrollLeft()-e),d=-e,S()},N=function(e){var t={};return t.left=e.offset().left-c.grid,t.width=e.width(),t.right=t.left+t.width,t.fits=p.pointer<t.right&&p.pointer>t.left,t.group=e.data("group"),t.$viewport=e,t},C=function(){var e,t;if(m!=null&&p.pointer<m.right&&p.pointer>m.left)return;if(p.pointer<c.viewport){e=l.groupConfig.prev;while(e!=null){t=N(n.viewports[n.firstWaffer.id][e.id].$viewport);if(t.fits)break;t=null,e=e.prev}}else{e=l.groupConfig.next;while(e!=null){t=N(n.viewports[n.firstWaffer.id][e.id].$viewport);if(t.fits)break;t=null,e=e.next}}if(t==null)s.hide(),s.css("width",0),s.css("left",0),m=null;else{if(m!==t){if(n.widget._trigger("before-change-column-group",null,{currentGroup:l.group,dropGroup:t.group,column:f.attr("data-index")})===!1)return;s.css("width",t.width),s.css("left",t.left),m=t}s.show(),i.hide(),r.hide()}},k=function(){var e=a[o];o-1===u?e=a[u]:o===a.length&&(e=a[o-1]),p.line=e.$th.offset().left-c.grid,o===a.length&&(p.line+=e.width),p.line>c.viewportRight?p.line=c.viewportRight:p.line<c.viewport&&(p.line=c.viewport),i.css("left",p.line),i.show()},L=function(){t.each(l.$thead.children().children(),function(t){var n=e(t);if(n.attr("data-index")!=="row-selector"){var r=n.position().left,i=parseInt(n.attr("width"),10);a.push({dataIndex:n.attr("data-index"),$th:n,left:r,right:r+i,width:i,middle:r+i/2}),f.data("index")===n.data("index")&&(u=a.length-1,o=u+1)}})};return{initColumnDrag:function(i,s,o){f=i,l=s,f.addClass("col-moving"),c.grid=n.$grid.offset().left,c.viewport=l.$viewport.offset().left-c.grid,h.th=parseInt(f.attr("width"),10),h.thMiddle=h.th/2,h.viewport=l.$viewport.width(),c.viewportRight=c.viewport+h.viewport,p.pointer=o-c.grid,r.css("width",h.th),L(),m=null,n.$grid.on("mousemove.col-move",t.throttle(g(),20)),e(document.body).on("mouseup.col-move",b()),y(o+e(window).scrollLeft())}}}}),define("gridapi.text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("gridapi.templates/grid/templates/grid.htm",[],function(){return'<script type="text/html" class="htm-grid-layout">\n    <div class="scrolly-grid" tabIndex="0">\n\n        <div class="col-move-shade" style="top : 34px;"></div>\n        <div class="col-move-bar" style="top : 34px;"></div>\n        <div class="col-group-drop-shade"></div>\n        <div class="row-move-shade"><div class="count"><span></span></div></div>\n        <div class="row-move-bar"></div>\n        <div class="waffer-drop-shade"></div>\n    </div>\n</script>\n\n<script type="text/html" class="htm-scroll-shims">\n    <div class="bottom-scroll-shim"></div>\n    <div class="right-scroll-shim"></div>\n</script>\n\n<script type="text/html" class="htm-viewport">\n    <div class="viewport viewport-<%=type%> viewport-<%=waffer%>" data-waffer=<%=waffer%> data-group=<%=group%>\n        id="<%=waffer%>-<%=group%>">\n        <table class="pgbu-grid">\n            <thead></thead>\n            <tbody></tbody>\n            <tfoot></tfoot>\n        </table>\n    </div>\n</script>\n\n<script type="text/html" class="htm-waffer-flex">\n    <div class="grid-waffer waffer-flex waffer-<%=id%>" data-id=<%=id%> data-type="flex">\n    </div>\n</script>\n\n<script type="text/html" class="htm-waffer-fixed">\n    <div class="grid-waffer waffer-fixed waffer-<%=id%>" data-id=<%=id%> data-type="fixed"></div>\n</script>\n\n<script type="text/html" class="htm-row">\n    <tr data-id="<%=id%>" data-group-id=<%=groupId%>></tr>\n</script>\n\n<script type="text/html" class="htm-pseudoscroller">\n    <div class="pseudo-scroller <%=type%>" id="scroller-<%=id%>">\n        <div class="empty-content"></div>\n    </div>\n</script>\n\n<script type="text/html" class="htm-header-col">\n    <th class="pgbu-cell" title="<%=tooltip%>" data-index="<%=dataIndex%>" width="<%=width%>">\n        <div class="<%=align%>"><%=title%></div>\n    </th>\n</script>\n<script type="text/html" class="htm-header-shim">\n    <th class="pgbu-cell header-shim" data-index="<%=dataIndex%>" width=<%=width%>></th>\n</script>\n<script type="text/html" class="htm-group-resizer">\n    <div class="group-resize-bar group-<%=id%>" data-group=<%=id%>>\n        <div class="resize-line"></div>\n    </div>\n</script>\n\n<script type="text/html" class="menu-container-markup">\n    <ul class="menu-container"></ul>\n</script>\n\n<script type="text/html" class="sub-menu-container-markup">\n    <div class="sub-menu-container"></div>\n</script>\n\n\n<script type="text/html" class="menu-item-template">\n    <li class="menu-item">\n        <div class="menu-icon" ></div>\n        <%=name%>\n    </li>\n</script>\n\n<script type="text/html" class="switchable-filter-interface">\n    <div class="switchable-filter-interface">\n        <div class="radio-container">\n            <div class="range">\n                <input type="radio" name="switchable" >\n            </div>\n            <div class="equals">\n                <input type="radio" name="switchable">\n            </div>\n        </div>\n\n        <div class="switchable-inputs-container">\n            <div class="switchable-top">\n                <div class="inputs-range-container">\n                    <div class="switchable-input-greater">\n                        <div class="icon"><</div>\n                        <div class="content">\n                            <input type="text" class="greater" />\n                        </div>\n                    </div>\n                    <div class="switchable-input-lesser">\n                        <div class="icon">></div>\n                        <div class="content">\n                            <input type="text" class="lesser" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="switchable-bottom">\n                <div class="inputs-equals-container">\n                    <div class="switchable-input-equals">\n                        <div class="icon">=</div>\n                        <div class="content">\n                            <input type="text" class="equals" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</script>\n\n\n'}),define("gridapi.grid/sizeFns",["gridapi.jquery","gridapi.underscore"],function(e,t){function r(e){var n=2;return t.each(t.pluck(t.filter(e.columns,function(e){return e.visible}),"width"),function(e){n+=parseInt(e,10)}),e.combinedColumnWidth=n,n}function i(e,n,r){var i=r-n.width;n.width=r;var s=t.filter(e,function(e){if(e.type==="flex"&&e.id!==n.id)return!0}),o=0;t.each(t.pluck(s,"width"),function(e){o+=e}),t.each(s,function(e){var t=e.width/o;e.width=e.width-parseInt(i*t,10)})}function s(e){return(e.records.length+(e.headerRow?1:0))*n}var n=31;return{resizeWaffersFn:function(e,r){var i=1;t.each(e.config.waffers,function(s){if(!t.isNull(s.calculatedHeight)&&!t.isUndefined(s.calculatedHeight)){var o=e.$waffers[s.id];o.css("height",s.calculatedHeight),r?o.css("margin-right","15px"):o.css("margin-right","0");if(s.type==="flex"){var u=e.pseudoScrollers.vertical[s.id];u.$scroller.css("height",s.calculatedHeight),u.$scroller.css("top",i),u.$content.css("height",s.contentHeight),u.$scroller.scrollTop(e.virtualRows[s.id].displayTop*n)}i+=s.calculatedHeight+2,e.virtualRows[s.id].visibleRows=Math.floor(s.calculatedHeight/n)}})},resizeGroupsFn:function(e,n){var r=0,i=0;t.each(e.config.groups,function(s){if(!t.isNull(s.width)&&!t.isUndefined(s.width)){i+=2,e.viewports["$group-"+s.id].css("width",s.width-2);if(s.type==="flex"){var o=e.resizers.group[s.id];o!=null&&o.$selector.css("left",r+s.width-i);var u=e.pseudoScrollers.horizontal[s.id];u.$scroller.css("width",s.width),u.$scroller.css("left",r),u.$content.css("width",s.combinedColumnWidth),u.$scroller.css("top",n-15)}r+=s.width+2}})},calculateWafferHeights:function(e,n,r){var i=0,o=0,u=!1;n-=e.config.waffers.length*2,r&&(n-=e.options.scrollbar.extraHeight);var a=t.filter(e.config.waffers,function(e){return e.type==="fixed"});t.each(a,function(t){t.height!=null?o=t.height:o=s(e.virtualRows[t.id]),t.calculatedHeight=o,i+=o});var f=t.filter(e.config.waffers,function(e){return e.type==="flex"}),l=n-i,c=0;return t.each(f,function(t,n){var r=parseInt(l*(t.percent/100),10),i=s(e.virtualRows[t.id]);t.squash&&r>i&&(r=i),i>r&&(u=!0),c+=r,n+1===f.length&&(t.squash==null||!t.squash)&&(r+=l-c),t.calculatedHeight=r,t.contentHeight=i}),u},calculateGroupWidths:function(e,n,i){var s=0,o=0,u,a=!1;i&&(n-=e.options.scrollbar.extraWidth);var f=t.filter(e.config.groups,function(e){return e.type==="fixed"}),l=t.filter(e.config.groups,function(e){return e.type==="flex"});t.each(f,function(e){var t=r(e);s+=t,e.width=t}),t.each(l,function(e){var t=0,n=r(e);e.width!=null&&!isNaN(e.width)?t=e.width:t=n,o+=t});var c=0,h=e.options.sizing.minGroupWidth*l.length;u=s;var p=n-s-h;return t.each(l,function(r,i){var s=(r.width!=null&&!isNaN(r.width)?r.width:r.combinedColumnWidth)/o,f=parseInt(p*s,10)+e.options.sizing.minGroupWidth;u+=f,i===l.length-1&&u<n&&(f+=n-u),r.combinedColumnWidth<f&&(c+=f-r.combinedColumnWidth,f=t.clone(r.combinedColumnWidth)),r.width=f,r.width<r.combinedColumnWidth&&(a=!0)}),c>0&&t.each(l,function(e,t){var n=e.combinedColumnWidth-e.width;if(n>0&&c>0){var r=c<n?c:n;e.width+=r,c-=r}}),a},resizeDraggedGroupFn:function(n,r){return function(){n.$grid.off("mousemove.group-resize"),e(document.body).off("mouseup.group-resize"),r.$selector.removeClass("dragging");var s=n.viewports[t.first(n.config.waffers).id][r.group.id],o=s.$viewport.position().left;i(n.config.groups,r.group,r.$selector.position().left-o),n.widget._trigger("view-updated",null,{action:"group-resized",group:r.group.id}),n.resize()}},onGroupDragFn:function(e,t){var n=this;return function(r){r.which===1&&n.moveResizeBarFn(e,r.clientX-t)}},moveResizeBarFn:function(e,t){e.$selector.is(".dragging")&&e.$selector.css("left",t)}}}),define("gridapi.grid/rows/rowMoveFns",["gridapi.jquery","gridapi.underscore"],function(e,t){return function(n){var r=n.$grid.find(".row-move-shade"),i=n.$grid.find(".row-move-bar"),s=n.$grid.find(".waffer-drop-shade"),o=e(),u=[],a={},f={},l,c,h,p,d,v={},m=-1,g,y=null,b=function(){return function(t){w(t.clientY+e(window).scrollTop())}},w=function(e){m=e-a.grid-v.pointer,v.pointer=e-a.grid,S(),y==null&&C()},E=function(){return function(t){if(t.which===1){n.$grid.off("mousemove.row-move"),e(document.body).off("mouseup.row-move"),clearTimeout(g);if(y==null){var u=n.virtualRows[p],a=-1;h>0&&(a=u.records[u.displayTop+h-(1+(u.headerRow?1:0))]),n.widget._moveRows({previousRecord:a,waffer:p})}else n.widget._dropRows(p,y.waffer);i.hide(),r.hide(),s.hide(),o.removeClass("row-moving"),y=null,h=null}}},S=function(){g!=null&&(clearTimeout(g),g=null);if(v.pointer>a.wafferTop+f.row&&v.pointer+f.row<a.wafferBottom){r.css("top",v.pointer-f.halfrow),r.show(),s.hide(),y=null;return}if(v.pointer<a.wafferTop||v.pointer>a.wafferBottom){N();return}s.hide(),y=null;var e=v.pointer-f.halfrow,t=v.pointer+f.halfrow,n=0;e<a.wafferTop?(e=a.wafferTop,n=15):t>a.wafferBottom&&(e=a.wafferBottom-f.row,n=-15),r.css("top",e),r.show(),n!==0&&(g=setInterval(function(){x(n)},150))},x=function(e){l!=null&&(l.$scroller.scrollTop(l.$scroller.scrollTop()-e),m=-e,C())},T=function(e){var t={};return t.top=e.offset().top-a.grid,t.height=e.height(),t.bottom=t.top+t.height,t.fits=v.pointer<t.bottom&&v.pointer>t.top,t.waffer=e.data("id"),t},N=function(){var e,t;if(y!=null&&v.pointer<y.bottom&&v.pointer>y.top)return;if(v.pointer<a.wafferTop){e=c.prev;while(e!=null){t=T(n.$waffers[e.id]);if(t.fits)break;t=null,e=e.prev}}else{e=c.next;while(e!=null){t=T(n.$waffers[e.id]);if(t.fits)break;t=null,e=e.next}}if(t==null)s.css("height",0),s.css("top",0),y=null,s.hide();else if(y!==t){if(t.waffer==="headers"||n.widget._trigger("before-drop-row",null,{currentWaffer:p,dropWaffer:t.waffer,rows:u})===!1)return;t.permission=!0,s.css("height",t.height),s.css("top",t.top),y=t,s.show(),i.hide(),r.hide()}},C=function(){var e=f.row;m<0&&(e=0),h=parseInt((v.pointer-a.wafferTop+e)/f.row,10);var t=f.row*h+a.wafferTop;t<a.wafferTop?t=a.wafferTop:t>a.wafferBottom&&(t=a.wafferBottom),i.css("top",t),i.show()};return{initMoveRow:function(i,s,v){var m=n.widget.getSelection().length;r.find(".count span").text(m+" Selected"),c=i.data("waffer"),p=i.data("id"),l=n.pseudoScrollers.vertical[i.data("id")],a.grid=n.$grid.offset().top,a.wafferTop=i.offset().top-a.grid,a.wafferBottom=a.wafferTop+i.height(),f.row=s.first().innerHeight(),f.halfrow=f.row/2,f.rows=f.row*s.length,d=parseInt(s.first().position().top/f.row,10),p==="headers"&&(a.wafferTop=a.wafferTop+f.row,d--),y=null,h=null,o=s,o.each(function(){u.push(e(this).attr("data-id"))}),r.show(),o.addClass("row-moving"),r.css("height",f.rows),n.$grid.on("mousemove.row-move",t.throttle(b(),20)),e(document.body).on("mouseup.row-move",E()),w(v+e(window).scrollTop())}}}}),define("gridapi.grid/gridMixins",["gridapi.underscore"],function(e){var t=function(){},n=function(n,r,i){var s;return r&&r.hasOwnProperty("constructor")?s=r.constructor:s=function(){n.apply(this,arguments)},e.extend(s,n),t.prototype=n.prototype,s.prototype=new t,r&&e.extend(s.prototype,r),i&&e.extend(s,i),s.prototype.constructor=s,s.__super__=n.prototype,s};return{"extends":function(e,t){var r=n(this,e,t);return r.extend=this.extend,r}}}),define("gridapi.grid/columns/core/editor",["gridapi.jquery","gridapi.underscore","gridapi.grid/gridMixins"],function(e,t,n){var r=t.template('<div id="pgbu-grid-cell-editor" class="cell-editor cell-editor-text"><input type="text"/></div>'),i=function(){};return i.extend=n.extends,t.extend(i.prototype,{init:function(e){var n=this,r=[];t.each(e,function(e,t){n[t]=e,r.push(t)}),this.commitStarted=!1,n.prop=r},initialize:function(t){var n=this;n.init(t);var r=n.make();if(!r.is(".cell-editor"))throw new Error('Editor.create() - No "cell-editor" class.');if(!r.is("#pgbu-grid-cell-editor"))throw new Error('Editor.create() - No "pgbu-grid-cell-editor" id.');return e(document.body).append(r),n.initListeners(),r},getEditor:function(){return e(document.body).find("#pgbu-grid-cell-editor")},getEditorInput:function(){return this.getEditor().find("input")},initListeners:function(){var t=this,n=this.getEditorInput();n.on("dblclick",function(e){e.stopPropagation(),e.preventDefault()}),n.on("keyup",function(n){switch(n.keyCode){case e.ui.keyCode.ENTER:t.commit(!1);break;case e.ui.keyCode.ESCAPE:t.close()}n.stopPropagation(),n.preventDefault()}),n.on("keydown",function(t){switch(t.keyCode){case e.ui.keyCode.ESCAPE:case e.ui.keyCode.ENTER:case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:case e.ui.keyCode.RIGHT:case e.ui.keyCode.LEFT:t.stopPropagation()}})},make:function(){return e(r({}))},setPosition:function(e){throw new Error("Editor.setPosition() needs to implemented.")},getNewData:function(){throw new Error("Editor.getNewData() needs to implemented.")},getCommitStarted:function(){return this.commitStarted},show:function(e,t){this.render(e,t);var n=this.getEditor();this.setPosition(n),n.show(),this.drawFocusToInput()},render:function(e,t){if(e!=null){var n=String.fromCharCode(e);this.getEditorInput().val(t?n.toLocaleUpperCase():n.toLocaleLowerCase())}else this.validate()?this.getEditorInput().val(this.format()):this.getEditorInput().val(this.data)},format:function(){return this.column.formatter.format(this.data)},validate:function(){return this.column.formatter.validate(this.data)},destroy:function(){var e=this.getEditor();e.length&&e.remove()},drawFocusToInput:function(e){var t=this.getEditorInput();t.get(0).focus(),e&&t.select()},clean:function(){var e=this;t.each(e.prop,function(t){delete e[t]}),delete e.newData,this.commitStarted=!1},hasDataChanged:function(){return!t.isEqual(this.getNewData(),this.data)},close:function(){this.destroy(),this.onCloseFn(),this.clean()},commit:function(e){return this.commitStarted=!0,this.onPersistFn(this.getNewData()),this.close(),!0}}),i}),define("gridapi.grid/columns/core/renderer",["gridapi.jquery","gridapi.underscore","gridapi.grid/gridMixins"],function(e,t,n){var r=function(){};r.extend=n.extends;var i={left:"",right:"cell-align-right",center:"cell-align-center"};return t.extend(r.prototype,{create:function(e,t,n,r,i,s){var o=this.validate(e,n),u=o?this.format(e,n,t):n,a='<td data-index="'+e.dataIndex+'"'+this.getClasses(r,i,s,o)+' ><div class="cell-renderer '+this.getAlignment(e)+'">'+u+"</div>"+(o?"":'<div class="invalid-top-right"></div>')+"</td>";return a},getClasses:function(e,t,n,r){var i="";return i=' class="pgbu-cell '+(e?"cell-modified ":"")+(t?"cell-uneditable ":"")+(n?"cell-selected ":"")+(r?"":"cell-invalid ")+'" ',i},validate:function(e,t){return e.formatter.validate(t)},format:function(e,t,n){return t==null?"":e.formatter.format(t)},getAlignment:function(e){return" "+i[e.align]||i.left}}),r}),define("gridapi.grid/columns/checkColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/renderer","gridapi.grid/columns/core/editor"],function(e,t,n,r){return{editor:r.extend({}),renderer:n.extend({create:function(e,t,n,r,i,s){var o=n===!0||n==="true"?'checked="checked"':"",u='<td data-index="'+e.dataIndex+'"'+this.getClasses(r,i,s,!0)+' ><div class="cell-renderer cell-renderer-checkbox'+this.getAlignment(e)+'">'+'<input type="checkbox" '+o+'"/></div></td>';return u}})}}),define("gridapi.grid/columns/selectColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer"],function(e,t,n,r){var i=t.template('<div id="pgbu-grid-cell-editor" class="cell-editor cell-editor-select"><input type="text"/><a class="btn dropdown-toggle btn-blue-light"><span class="caret"/></a><ul class="hide cell-select-menu"></ul></div>'),s=t.template('<li class="select-menu-item <%=selected%>" data-id="<%=dataId%>"><%=name%></li>'),o=t.template('<li class="select-menu-item <%=selected%>" data-id="<%=dataId%>"><input type="checkbox" <%=checked%> class="dropdown-checkbox"><%=name%></li>');return{formatter:{format:function(e,n){var r="";return n.selectMultiple?t.each(e,function(t,i){r+=n.selectValues[t].name,i<e.length-1&&(r+=n.listDelim)}):n.selectValues[e]!=null&&(r=n.selectValues[e].name),r},validate:function(e){return!0}},renderer:r.extend({format:function(e,t,n){return e.formatter.format(t,e)}}),editor:n.extend({init:function(e){this.newData=t.clone(e.data),this.constructor.__super__.init(e)},updateData:function(e){var t=this;if(t.column.selectMultiple){var n=!1;for(var r=0;r<t.newData.length;r++){var i=t.newData[r];if(e===i){t.newData.splice(r,1),n=!0;break}}n||t.newData.push(e)}else t.newData=e;t.render()},getNewData:function(){return this.newData},make:function(){var t=this;if(t.column.selectValues==null||t.column.selectValues.length===0)throw new Error("DropDownColumn.make() - no values defined.");var n=e(i({})),r=n.find("ul"),s=n.find("input");return t.column.selectMultiple&&(n.addClass("cell-editor-select-multi"),r.addClass("cell-select-multi-menu")),t.createDropDown(r,t.column.selectValues),n.find("a.dropdown-toggle").on("click",function(e){r.toggleClass("hide"),n.find("input").get(0).focus(),e.stopPropagation(),e.preventDefault()}),n},createDropDown:function(n,r){var i=this;n.empty(),t.each(r,function(r){if(i.column.selectMultiple){var u=t.indexOf(i.data,r.id)>-1;n.append(e(o({dataId:r.id,name:r.name,checked:u?'checked="checked"':"",selected:u?"menu-item-selected":""})))}else{var a=r.id===i.data;n.append(e(s({dataId:r.id,name:r.name,selected:a?"menu-item-selected":""})))}});var u=n.find("li");u.on("dblclick",function(e){return e.stopPropagation()}),u.find('input[type="checkbox"]').on("change",function(t){var n=e(this),r=n.closest("li"),s=r.attr("data-id");n.is(":checked")?r.addClass("menu-item-selected"):r.removeClass("menu-item-selected"),i.updateData(s),i.getEditorInput(i.getEditor()).get(0).focus(),t.stopPropagation()}).on("click",function(e){e.stopPropagation()}),u.on("mouseover",function(e){n.find("li.item-hovered").addClass("menu-item-hovered-transparent")}),u.on("click",function(t){var n=e(this),r=n.closest("li"),s=r.attr("data-id"),o=r.find("input");r.is(".menu-item-selected")?(r.removeClass("menu-item-selected"),o.length&&o.removeAttr("checked")):(o.attr("checked","checked"),o.length&&r.addClass("menu-item-selected")),i.updateData(s),i.column.selectMultiple?i.getEditorInput(i.getEditor()).get(0).focus():i.commit(),t.stopPropagation()})},moveSelection:function(e,t){var n=e.children(),r=n.filter(".menu-item-hovered");r.length||(r=n.filter(".menu-item-selected"));if(!r.length)r=n.first().addClass("menu-item-hovered");else{r=r.eq(0),r.removeClass("menu-item-hovered");var i=t?r.prev():r.next();i.length||(i=t?n.last():n.first()),i.addClass("menu-item-hovered")}},initListeners:function(){var t=this,n=t.getEditor().find(".cell-select-menu"),r=t.getEditor().find("a.dropdown-toggle"),i=t.getEditorInput();i.on("keyup",function(s){n.find(".menu-item-hovered").removeClass("menu-item-hovered-transparent");switch(s.keyCode){case e.ui.keyCode.ENTER:var o=n.children();o.filter(".menu-item-hovered").trigger("click"),t.commit(s.keyCode);break;case e.ui.keyCode.ESCAPE:t.close();break;case e.ui.keyCode.UP:n.is(".hide")||t.moveSelection(n,!0);break;case e.ui.keyCode.DOWN:n.is(".hide")?r.trigger("click"):t.moveSelection(n,!1);break;case e.ui.keyCode.SPACE:n.find("li.menu-item-hovered").click(),t.column.selectMultiple||t.commit(s.keyCode);break;default:t.autoComplete(i.val())}}),i.on("keydown",function(t){switch(t.keyCode){case e.ui.keyCode.ENTER:case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:case e.ui.keyCode.RIGHT:case e.ui.keyCode.SPACE:t.stopPropagation(),t.preventDefault()}})},autoComplete:function(n){var r=this,i=[],s=r.getEditor().find(".cell-select-menu"),o=n.toLowerCase().split(r.column.listDelim).pop();if(r.column.selectMultiple){var u=s.children().filter(".menu-item-selected");t.each(r.column.selectValues,function(n){t.each(u,function(t){n.id===e(t).attr("data-id")&&i.push(n)})})}t.each(r.column.selectValues,function(e){e.name.toLowerCase().indexOf(o)===0&&(t.contains(i,e)||i.push(e))}),r.createDropDown(s,i),s.children().first().addClass("menu-item-selected"),s.is(".hide")&&s.toggleClass("hide")},render:function(e,t){e==null?this.getEditorInput().val(this.column.formatter.format(this.newData,this.column)):this.constructor.__super__.render(e,t)},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/spinnerColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer"],function(e,t,n,r){return{renderer:r.extend({}),editor:n.extend({make:function(){return e('<div id="pgbu-grid-cell-editor" class="cell-editor cell-editor-spinner"><input type="number"/></div>')},getNewData:function(){return this.getEditorInput().val()},render:function(){var e=this,t=this.getEditorInput();t.spinner({type:e.column.spinnerType,style:"self",fallback:!0,min:e.column.spinnerMin,max:e.column.spinnerMax,step:e.column.spinnerStep}),t.val(this.data),e.getEditor().find(".spinner-btn").on("dblclick",function(e){e.stopPropagation()})},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/rowSelectorColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/checkColumn","gridapi.grid/columns/core/editor"],function(e,t,n,r){return{editor:r.extend({init:function(e,t,n,r,i){this.constructor.__super__.init(e,t,n,r,i)}}),renderer:n.renderer.extend({thTemplate:t.template('<th data-index="<%=dataIndex%>" width="<%=width%>"><div class="cell-renderer align-center"><input type="checkbox"/></div></td>'),create:function(e,t,n){var r=n===!0||n==="true"?'checked="checked"':"",i='<td data-index="'+e.dataIndex+'"><div class="cell-renderer cell-renderer-selector-checkbox'+this.getAlignment(e)+'">'+'<input type="checkbox" '+r+'"/></div></td>';return i}})}}),define("gridapi.grid/columns/textColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer"],function(e,t,n,r){return{renderer:r.extend({}),editor:n.extend({getNewData:function(){return this.getEditorInput().val()},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/i18n/localizedStrings",[],function(){return{sortAscending:"Sort Ascending",sortDescending:"Sort Descending",columnToggle:"Columns",filter:"Filter",dates:{mm:"mm",dd:"dd",yyyy:"yyyy",today:"Today",cancel:"Cancel"},invalidFormatError:"Format not correct for cell.",picker:{save:"Select",cancel:"Cancel",search:"search",title:"Select {set my locale}"},enterNumber:"Enter number..."}}),define("gridapi.grid/columns/dateColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer","gridapi.grid/i18n/localizedStrings"],function(e,t,n,r,i){return{formatter:{format:function(e,t){return e==null||e===""?"":(new Date(e)).format(t,!0)},validate:function(e){return e==null||e===""?!0:(new Date(e)).toString()!=="Invalid Date"}},renderer:r.extend({format:function(e,t){return e.formatter.format(t,e.dateFormat)}}),editor:n.extend({init:function(e){this.constructor.__super__.init(e)},make:function(){this.isValid=!0;var e=this.constructor.__super__.make();return e.addClass("cell-editor-date"),e},getNewData:function(){var e=this.getEditorInput().datePicker("getDate");return e.toString()!=="Invalid Date"?e.toJSON():e},format:function(){return this.column.formatter.format(this.data,this.column.dateFormat)},render:function(e,t){var n=this,r=this.getEditorInput();r.datePicker({style:"self",fallback:!0,dateFormat:n.column.dateFormat,type:n.column.dateType,locale:{today:i.dates.today,cancel:i.dates.cancel}}),n.getEditorInput().datePicker("setDate",new Date(n.data)),n.constructor.__super__.render.call(n,e,t)},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/textAreaColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer"],function(e,t,n,r){return{renderer:r.extend({}),editor:n.extend({make:function(){var t=this,n=e('<div id="pgbu-grid-cell-editor" class="cell-editor cell-editor-textarea"><textarea rows="3" cols="100"></textarea></div>'),r=t.getEditorInput(n);return r.on("mousewheel",function(e){e.stopPropagation()}),n},getNewData:function(){return this.getEditorInput().val()},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left)},getEditorInput:function(){return this.getEditor().find("textarea")}})}}),define("gridapi.grid/columns/pickerColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer"],function(e,t,n,r){return{formatter:{format:function(e,n){var r="";return t.each(e,function(t,i){r+=t.name,i<e.length-1&&(r+=n.listDelim)}),r},validate:function(e){return!0}},renderer:r.extend({format:function(e,t,n){return e.formatter.format(t,e)}}),editor:n.extend({init:function(e){this.newData=t.clone(e.data),this.constructor.__super__.init(e)},make:function(){var e=this.constructor.__super__.make();return e.addClass("cell-editor-picker"),e},render:function(n,r){var i=this,s=this.getEditorInput(),o={style:"self",storeFns:{submit:function(e){i.newData=e,i.render()}},typeahead:{storeFns:{filter:function(e){s.picker("filter",e)},submit:function(e){i.newData=e,i.render()}}}};e.extend(!0,o,{rootId:i.column.pickerRootId,locale:i.column.pickerLocale,lazyload:i.column.pickerLazyLoad,multiSelect:i.column.pickerSelectMultiple,storeFns:i.column.pickerStoreFns,display:i.column.pickerDisplayFormat,typeahead:i.column.pickerTypeaheadStoreFns}),s.picker(o),t.each(i.data,function(e){s.picker("select",e.id)}),n==null?this.getEditorInput().val(this.column.formatter.format(this.newData,this.column)):this.constructor.__super__.render(n,r)},getNewData:function(){return this.newData},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/costColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer","pgbucoreapi.numberFormatter"],function(e,t,n,r,i){return{formatter:i,renderer:r.extend({validate:function(e,t){return t==null||t===""?!0:e.formatter.validate(t,{decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator,symbol:e.symbol})},format:function(e,t,n){return e.formatter.format(t,{decimalPlaces:e.decimalPlaces,decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator,symbol:e.symbol,prefixSymbol:e.prefixSymbol})}}),editor:n.extend({make:function(){var e=this.constructor.__super__.make();return e.addClass("cell-editor-cost"),e},getNewData:function(){var e=this.getEditorInput().val();return e=e.replace(this.column.thousandsSeparator,""),e=e.replace(this.column.symbol,""),e},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/percentColumn",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer","pgbucoreapi.numberFormatter"],function(e,t,n,r,i){return{formatter:i,renderer:r.extend({validate:function(e,t){return t==null||t===""?!0:e.formatter.validate(t,{decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator,symbol:e.symbol})},format:function(e,t,n){return e.formatter.format(t,{decimalPlaces:e.decimalPlaces,decimalSeparator:e.decimalSeparator,thousandsSeparator:e.thousandsSeparator,symbol:e.symbol,prefixSymbol:e.prefixSymbol})}}),editor:n.extend({make:function(){var e=this.constructor.__super__.make();return e.addClass("cell-editor-cost"),e},format:function(){return this.column.formatter.format(this.data,{decimalPlaces:this.column.decimalPlaces,decimalSeparator:this.column.decimalSeparator,thousandsSeparator:this.column.thousandsSeparator,symbol:this.column.symbol,prefixSymbol:this.column.prefixSymbol})},getNewData:function(){var e=this.getEditorInput().val();return e=e.replace(this.column.thousandsSeparator,""),e=e.replace(this.column.symbol,""),e},setPosition:function(e){var t=this.$cell.offset();e.css("top",t.top),e.css("left",t.left),e.css("width",this.$cell.css("width")),e.css("height",this.$cell.css("height"))}})}}),define("gridapi.grid/columns/core/defaultFormatter",[],function(){return{format:function(e){return e},validate:function(e){return!0}}}),define("gridapi.grid/columns/core/columnDefinitionFns",["gridapi.jquery","gridapi.underscore","gridapi.grid/columns/core/editor","gridapi.grid/columns/core/renderer","gridapi.grid/columns/checkColumn","gridapi.grid/columns/selectColumn","gridapi.grid/columns/spinnerColumn","gridapi.grid/columns/rowSelectorColumn","gridapi.grid/columns/textColumn","gridapi.grid/columns/dateColumn","gridapi.grid/columns/textAreaColumn","gridapi.grid/columns/pickerColumn","gridapi.grid/columns/costColumn","gridapi.grid/columns/percentColumn","gridapi.grid/i18n/localizedStrings","gridapi.grid/columns/core/defaultFormatter"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m={left:"cell-align-left",right:"cell-align-right",center:"cell-align-center"},g={text:a,textArea:l,date:f,check:i,select:s,spinner:o,picker:c,cost:h,percent:p,rowSelector:u},y=["string","integer","float","date","boolean","enum"],b={string:["text","textArea","picker"],integer:["text","spinner"],"float":["text","spinner","cost"],date:["text","date"],"boolean":["text","check"],"enum":["select"]},w={dataIndex:"_no-data-index_",title:"_no-header_",tooltip:"",headerAlign:"left",align:"left",width:"100px",resizable:!1,draggable:!1,displayType:"text",dataType:"string",readOnly:!1,filterable:!1,sortable:!1,hideable:!1,menu:!1,formatter:v,spinnerMin:null,spinnerMax:null,spinnerStep:1,spinnerType:"number",selectValues:{},selectMultiple:!1,dateType:"date",dateFormat:"mmm dd yyyy",pickerDisplayFormat:null,pickerRootId:"0",pickerTypeaheadStoreFns:{},pickerLazyLoad:!1,pickerSelectMultiple:!1,pickerStoreFns:{},pickerLocale:{save:d.picker.save,cancel:d.picker.cancel,search:d.picker.search,title:d.picker.title},decimalSeparator:".",thousandsSeparator:",",symbol:"",prefixSymbol:!0,decimalPlaces:2,listDelim:",",renderer:new r,editor:new n,visible:!0};return function(n){if(n==null)throw new Error("columnDefintionFns.js - defined column is undefined.");if(n.dataIndex==null||n.dataIndex===""||n.dataIndex==="_no-data-index_")throw new SyntaxError("dataIndex property has not been set correctly for column.");if(n.dataIndex!=="row-selector")if(n.title==null||n.title===""||n.title==="_no-header_")throw new SyntaxError("title property has not been set correctly for column.");if(n.displayType==="select"&&t.isEmpty(n.selectValues))throw new SyntaxError("selectValues property has not been set correctly for the column displayType select");n.displayType==="cost"&&(n.symbol="$"),n.displayType==="percent"&&(n.symbol="%",n.prefixSymbol=!1);var r=t.clone(w),i=g[n.displayType||w.displayType];i!=null&&(i.editor!=null&&(r.editor=new i.editor),i.renderer!=null&&(r.renderer=new i.renderer),i.formatter!=null&&(r.formatter=i.formatter)),n.renderer!=null&&(r.renderer=new n.renderer,delete n.renderer),n.editor!=null&&(r.editor=new n.editor,delete n.editor),n.formatter!=null&&(r.formatter=n.formatter,delete n.formatter);var s={};return e.extend(!0,s,r,n),s}}),define("gridapi.grid/eventHandlers",["gridapi.jquery","gridapi.underscore"],function(e,t){var n=[48,49,50,51,52,53,54,55,56,57],r=[58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,78,79,80,81,82,83,84,85,86,87,88,89,90],i=[106,107,109,110,111],s=[186,187,188,189,190,191,192,219,220,221,222];return{focus:function(){var e=this;return function(t){e.widget.focus.record==null&&e.selectionModel.cell.firstCellInGrid()}},change:function(){var t=this;return function(n){var r=e(n.target),i=!1,s=r.closest("div.cell-renderer-checkbox").parent();if(s.length)i=s.find("input").is(":checked"),t.widget._cellUpdated(s.parent().attr("data-id"),s.attr("data-index"),i?"true":"false");else{var o=r.closest("div.cell-renderer-selector-checkbox").parent();o.length&&(i=o.find("input").is(":checked"),t.widget.checkRows([o.parent().attr("data-id")],i))}}},doubleClick:function(){var t=this;return function(n){var r=e(n.target),i=r.closest("td");if(i.length){var s=i.find("div.cell-renderer-checkbox");s.length||t.widget.editRow(i.parent().attr("data-id"),i.attr("data-index"),n)}}},scroll:function(){return function(e){return!1}},keydown:function(){var n=this,r=75,i=t.throttle(function(){n.selectionModel.cell.moveLeft()},r),s=t.throttle(function(){n.selectionModel.cell.moveRight()},r),o=t.throttle(function(){n.selectionModel.cell.moveUp()},r),u=t.throttle(function(){n.selectionModel.cell.moveDown()},r);return function(t){var n=e(t.target);switch(t.keyCode){case e.ui.keyCode.RIGHT:t.preventDefault(),s();break;case e.ui.keyCode.LEFT:t.preventDefault(),i();break;case e.ui.keyCode.UP:t.preventDefault(),o();break;case e.ui.keyCode.DOWN:t.preventDefault(),u();break;case e.ui.keyCode.HOME:t.preventDefault();break;case e.ui.keyCode.END:t.preventDefault();break;case e.ui.keyCode.ESCAPE:t.preventDefault();break;case e.ui.keyCode.SPACE:}}},keyup:function(){var o=this;return function(u){var a=e();switch(u.keyCode){case 89:o.options.editable&&u.ctrlKey&&o.widget.redo();break;case 90:o.options.editable&&u.ctrlKey&&o.widget.undo();break;case 83:o.options.editable&&u.shiftKey&&o.widget._trigger("save-accelerator");break;case 78:o.options.editable&&u.shiftKey&&o.widget._trigger("new-accelerator");break;case 86:o.options.editable&&u.ctrlKey&&o.widget.pasteRows();break;case 88:o.options.editable&&u.ctrlKey&&o.widget.cutRows();break;case 67:o.options.editable&&u.ctrlKey&&o.widget.copyRows();break;case e.ui.keyCode.SPACE:if(o.options.editable){u.preventDefault();if(o.widget.focus.record!=null){o.widget.selectCell(),a=o.selectionModel.focus.$td;var f=a.find('input[type="checkbox"]');if(a.length===1&&f.length===1){var l=f.is(":checked");l?f.removeAttr("checked"):f.attr("checked","checked"),f.trigger("change")}}}break;case e.ui.keyCode.END:u.ctrlKey?o.selectionModel.cell.lastCellInGrid():o.selectionModel.cell.lastCellInRow();break;case e.ui.keyCode.HOME:u.ctrlKey?o.selectionModel.cell.firstCellInGrid():o.selectionModel.cell.firstCellInRow();break;case e.ui.keyCode.ESCAPE:o.closeEditor(),o.closeMenus();break;case e.ui.keyCode.UP:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:case e.ui.keyCode.RIGHT:u.preventDefault();break;case 113:o.widget.focus.record!=null&&(o.widget.selectCell(),a=o.selectionModel.focus.$td,setTimeout(function(){o.widget.editRow(o.widget._getRecordId(o.widget.focus.record),o.widget.focus.columnId,{target:a,keyCode:null,shiftKey:null,ctrlKey:null})},10)),u.stopPropagation(),u.preventDefault()}(t.contains(n,u.keyCode)||t.contains(i,u.keyCode)||t.contains(s,u.keyCode)||t.contains(r,u.keyCode))&&o.widget.focus.record!=null&&(o.widget.selectCell(),a=o.selectionModel.focus.$td,setTimeout(function(){o.widget.editRow(o.widget._getRecordId(o.widget.focus.record),o.widget.focus.columnId,{target:a,keyCode:u.keyCode,shiftKey:u.shiftKey,ctrlKey:u.ctrlKey})},10))}},contextMenu:function(){var t=this;return function(n){var r=e(n.target);if(r.is(".context-menu-item")||r.parent().is(".context-menu-item"))return!1;if(r.is(".scrolly-grid"))t.selectionModel.focus.$td.is("th")?t.columnMenu.render(t.selectionModel.focus.$td,n,!0):t.widget.focus.record!=null&&(t.widget.selectCell(),t.contextMenu.render(t.selectionModel.focus.$td,n,!0));else{var i=r;i.is(".viewport")||(i=r.closest("td")),t.contextMenu.render(i,n,!1)}n.stopPropagation(),n.preventDefault()}},mousedown:function(){var t=this;return function(n){var r=e(n.target),i="";if(n.which===1||n.which===3)if(!r.is(".input")){var s=r.closest("td");if(s.length){n.which===1&&!r.is("th")&&(t.rowDragTimeout=setTimeout(function(){t.options.rows.draggable&&!t.config.sortBy.length&&t.rowMover.initMoveRow(s.closest("div.grid-waffer"),s.parent(),n.clientY)},200),e(document.body).on("mouseup",function(){clearTimeout(t.rowDragTimeout),e(document.body).off("mouseup")}));if(!s.is(".editing")){var o=s.parent(),u=!1;(!n.shiftKey&&!n.ctrlKey||!t.options.multiSelect)&&t.selectionModel.cell.cellSelected(s);var a=[];a.push(o.attr("data-id")),n.ctrlKey&&o.is(".row-selected")&&t.options.multiSelect?t.widget.deselectRows(a,n):n.shiftKey&&t.options.multiSelect?(a=t.selectionModel.getShiftSelection(o),t.widget.selectRows(a)):(n.ctrlKey&&t.options.multiSelect&&(u=!0),t.widget.selectRows(a,u,n))}}t.closeMenus(),n.stopPropagation()}}}}}),define("gridapi.grid/columnMenu/columnSubMenus",["gridapi.jquery","gridapi.underscore"],function(e,t){return{init:function(e,t,n,r){require(["gridapi.grid/columnMenu/columnTogglesMenu","gridapi.grid/menu"],function(i,s){var o=null;switch(n){case"columnToggle":o=i(e,r.column,r.toggleLayout);break;case"filter":break;default:throw new Error("subMenu.js - Invalid column type.")}var u=o.render();t.closest("ul").append(u),u.position({my:"left top",at:"right top",of:t,offset:"0 0",collision:"fit"}),s.selectFirstMenuItem(u.find("ul"))})}}}),define("gridapi.grid/menu",["gridapi.jquery","gridapi.underscore","gridapi.grid/columnMenu/columnSubMenus"],function(e,t,n){var r=t.template('<div class="gpbu-grid-menu"><ul></ul></div>'),i=t.template('<li data-action="<%=action%>"><a href="#"><img class="icon" src="<%=icon%>"><div class="name"><%=name%></div></a></li>'),s=t.template('<li data-index="<%=dataIndex%>" data-action="<%=action%>"><a href="#"><input type="checkbox" class="icon"<%=checked%>/><div class="name"><%=name%></div></a></li>'),o='<li class="divider"></li>';return{createMenu:function(n){var i=e(r(n));return t.each(n.classes,function(e){i.addClass(e)}),i},createMenuItem:function(n){var r=e(i(n));return t.each(n.classes,function(e){r.addClass(e)}),t.each(n.data,function(e,t){r.data(t,e)}),r},createMenuItemCheck:function(n){var r=e(s(n));return t.each(n.classes,function(e){r.addClass(e)}),t.each(n.data,function(e,t){r.data(t,e)}),r},addDivider:function(e){e.append(o)},attachListeners:function(t,n,r){var i=this,s=t.find("li"),o=t.closest(".root-menu");o.data("navigation-type","keyboard"),s.on("click",function(t){var i=e(this);if(i.is(".divider"))return;n[i.attr("data-action")].call(t,i,r)}),s.on("keyup",function(s){var u=t.find(".item-focused"),a=u.attr("data-action");o.data("navigation-type","keyboard"),o.find("li.item-focused").removeClass("item-focused-transparent");switch(s.keyCode){case e.ui.keyCode.ENTER:n[a].call(s,u,r);break;case e.ui.keyCode.SPACE:n[a].call(s,u,r);break;case e.ui.keyCode.UP:i.moveSelection(t,!0);break;case e.ui.keyCode.DOWN:i.moveSelection(t,!1);break;case e.ui.keyCode.RIGHT:u.trigger("mouseover",!0);break;case e.ui.keyCode.LEFT:var f=u.closest(".sub-menu");if(!f.is(".root-menu")&&f.length){var l=f.parent().find("li.item-focused");l.removeClass("item-focused-transparent"),i.drawFocus(l),u.parent().remove()}break;case e.ui.keyCode.ESCAPE:o=u.closest(".root-menu");var c=o.data("menu-api");c.destroy();break;default:s.stopPropagation(),s.preventDefault()}}),s.on("mouseover",function(t,s){var o=e(this),u=o.closest(".root-menu"),a=o.attr("data-action");s||(u.data("navigation-type","mouse"),u.find("li.item-focused").addClass("item-focused-transparent")),i.drawFocus(o),a==="check-column"?n[a].call(t,o,r):o.parent().find(".sub-menu").remove()})},moveSelection:function(e,t){var n=e.children(),r=n.filter(".item-focused"),i=e.closest(".root-menu");if(!r.length)r=n.first(),r.addClass("item-focused"),i.data("navigation-type")==="mouse"&&r.addClass("item-focused-transparent");else{r=r.eq(0),r.removeClass("item-focused");var s=t?r.prev():r.next();s.length||(s=t?n.last():n.first()),s.addClass("item-focused"),i.data("navigation-type")==="mouse"&&s.addClass("item-focused-transparent"),s.is(".divider")&&this.moveSelection(e,t),this.drawFocus(s)}},selectFirstMenuItem:function(e){var t=e.find("li");t.length&&(this.moveSelection(e,!1),this.drawFocus(t.eq(0)))},drawFocus:function(e){var t=e.find("a");t.length&&t.get(0).focus()}}}),define("gridapi.grid/contextMenu/contextMenuActions",["gridapi.jquery","gridapi.underscore"],function(e,t){return{action:function(t,n){var r=t.closest("ul"),i=r.closest(".root-menu"),s=i.data("menu-api");t!=null&&!t.length&&(t=r.find(".item-focused"));if(t.length){if(!t.is(".disabled")){var o=t.data("menu-action");e.isFunction(n.grid.widget[o])?n.grid.widget[o].call(n.grid.widget,{}):n.grid.widget._trigger(o,{})}s.destroy()}}}}),define("gridapi.grid/contextMenu/contextMenu",["gridapi.jquery","gridapi.underscore","gridapi.grid/menu","gridapi.grid/contextMenu/contextMenuActions"],function(e,t,n,r){function i(e){if(e.disabled){var t=e.icon.lastIndexOf("."),n=e.icon.slice(t),r=e.icon.slice(0,t);return r+"-disabled"+n}return e.icon}function s(e,t){var n=t.parent().attr("data-id");return e.widget.selectCell(n,t.attr("data-index")),e.widget.store.getRecord(n)}return function(s){var o=n.createMenu({classes:["root-menu"]}),u=o.find("ul"),a=!1;return o.attr("id","pgbu-grid-context-menu"),{render:function(f,l,c){var h=this,p=null,d=null;a=!1;if(!s.options.contextMenu.enabled)return;if(!s.closeEditor(!1))return;c?d=f.offset():d={left:l.pageX,top:l.pageY},f!=null&&f.length&&f.is("td")&&(p=s.widget.focus.record);var v=s.options.contextMenu.populate(p);v!=null&&v.length&&(u.empty(),o.data("menu-api",h),t.each(v,function(e){t.isEmpty(e)?n.addDivider(u):u.append(n.createMenuItem({action:"action",name:e.label,icon:i(e),classes:[e.disabled?"disabled":""],data:{"menu-action":e.action}}))}),o.css("left",d.left),o.css("top",d.top),n.attachListeners(u,r,{grid:s}),e(document.body).append(o),c&&n.selectFirstMenuItem(u),a=!0)},destroy:function(){a=!1,o.remove(),s.$grid.get(0).focus()},isOpen:function(){return a}}}}),define("gridapi.grid/columnMenu/columnMenuActions",["gridapi.jquery","gridapi.underscore","gridapi.grid/columnMenu/columnSubMenus"],function(e,t,n){return{"sort-asc":function(e,t){if(!e.is(".disabled")){var n=e.closest(".menu"),r=n.data("menu-api");t.grid.widget.sortRows(t.column.dataIndex,this.ctrlKey,"asc"),r.destroy()}},"sort-dsc":function(e,t){if(!e.is(".disabled")){var n=e.closest(".menu"),r=n.data("menu-api");t.grid.widget.sortRows(t.column.dataIndex,this.ctrlKey,"dsc"),r.destroy()}},"check-column":function(e,r){e.parent().find(".sub-menu").remove();if(e.is(".sub-menu-item")){e.addClass("item-focused-transparent");var i=e.data("dataLayoutIndex"),s=e.data("columnLayout");t.isNumber(i)&&(s=s.subMenus[i]),n.init(r.grid,e,"columnToggle",{toggleLayout:s,column:r.column})}},column:function(t,n){var r=t.closest(".menu"),i=r.data("menu-api");if(!t.is(".disabled")){var s=t.attr("data-action"),o=t.find('input[type="checkbox"]');e(this.target).is('input[type="checkbox"]')||(o.is(":checked")?o.removeAttr("checked"):o.attr("checked","checked"));var u=n.grid.columnDefinitions[t.attr("data-index")];n.grid.switchColumnVisibilty(u);if(n.column.dataIndex===u.dataIndex){var a=t.closest(".root-menu"),f=a.find('li[data-action^="sort-"]');u.visible?f.removeClass("disabled"):f.addClass("disabled")}i.disableLastColumnToggle()}}}}),define("gridapi.grid/columnMenu/columnMenu",["gridapi.jquery","gridapi.underscore","gridapi.grid/menu","gridapi.grid/columnMenu/columnMenuActions"],function(e,t,n,r){return function(t){function o(e){for(var n=0;n<t.config.sortBy.length;n++){var r=t.config.sortBy[n];if(e.dataIndex===r.key)return r.order}return""}function u(e){var i=n.createMenu({classes:["root-menu"]}),s=i.find("ul");i.attr("id","pgbu-grid-column-menu");if(e.sortable){var u=o(e);s.append(n.createMenuItem({name:t.options.locale.sortAscending,icon:"img/menu_sort_ascending.png",action:"sort-asc",classes:u==="asc"?["active"]:[]})),s.append(n.createMenuItem({name:t.options.locale.sortDescending,icon:"img/menu_sort_descending.png",action:"sort-dsc",classes:u==="dsc"?["active"]:[]})),n.addDivider(s)}return s.append(n.createMenuItem({name:t.options.locale.columnToggle,icon:"img/menu_table_column.png",action:"check-column",classes:["sub-menu-item"],data:{columnLayout:t.options.columnMenu.columnToggleMenu}})),n.attachListeners(s,r,{grid:t,column:e}),i}var i=!1,s=null;return{render:function(r,o,a){var f=t.columnDefinitions[r.attr("data-index")];if(!t.options.columnMenu.enabled||!f.menu)return;i=!1,this.destroy(),s=u.call(this,f);var l=s.find("ul");s.data("menu-api",this);var c=r.offset();s.css("left",c.left),s.css("top",c.top+r.outerHeight()),e(document.body).append(s),a&&n.selectFirstMenuItem(l),i=!0},destroy:function(){s!=null&&s.remove(),i=!1,t.$grid.get(0).focus()},isOpen:function(){return i}}}}),define("gridapi.grid/find",["gridapi.jquery","gridapi.underscore"],function(e,t){return function(n){function u(){r={},s=0,i.removeClass("found"),i=e(),t.each(n.config.waffers,function(e,r){t.each(n.config.groups,function(t,r){var i=n.viewports[e.id][t.id];i.$tbody.children().removeClass("hide")})}),o.trigger("position")}function a(e){var t=i.eq(e);n.widget.selectCell(t.parent().attr("data-id"),t.attr("data-index")),o.trigger("position")}function f(s){if(s.term===r.term&&s.hide===r.hide)return;u(),r=s;if(r.term==="")return;var f=new RegExp(r.term,"i"),l={},c=n.$grid.find("td"),h=t.filter(c,function(t){var n=e(t),r=f.test(n.text());if(s.hide){var i=n.parent();r?(l[i.attr("data-id")]="found",i.removeClass("hide")):l[i.attr("data-id")]||i.addClass("hide")}return r});o.trigger("values"),i=e(h),i.addClass("found"),a(0)}var r={},i=e(),s=0,o={trigger:function(e){switch(e){case"position":n.widget._trigger("find-position",null,{position:s+1,total:i.length});break;case"values":n.widget._trigger("find-values",null,{values:i.slice(0,10)})}}};return{search:function(e){f(e)},next:function(e){i.length&&(++s,s===i.length&&(s=0),a(s))},prev:function(e){i.length&&(--s,s<0&&(s=i.length-1),a(s))},reset:function(){u()}}}}),define("gridapi.grid/gridView",["gridapi.jquery","gridapi.underscore","gridapi.grid/sorters","gridapi.grid/selectionModel","gridapi.grid/columns/core/columnResizeFns","gridapi.grid/columns/core/columnMover","gridapi.templates/grid/templates/grid.htm","gridapi.grid/sizeFns","gridapi.grid/rows/rowMoveFns","gridapi.grid/columns/core/columnDefinitionFns","gridapi.grid/eventHandlers","gridapi.grid/contextMenu/contextMenu","gridapi.grid/columnMenu/columnMenu","gridapi.grid/find"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){function d(e,n,r){var i=e.filter(n).html();return r==null?i:t.template(i,r)}var v=31,m=e(o),g=e(d(m,".htm-grid-layout")),y=t.template(d(m,".htm-viewport")),b=t.template(d(m,".htm-row")),w=t.template(d(m,".htm-header-col")),E=t.template(d(m,".htm-header-shim")),S=t.template(d(m,".htm-pseudoscroller")),x=t.template(d(m,".htm-waffer-flex")),T=t.template(d(m,".htm-waffer-fixed")),N=e(d(m,".htm-scroll-shims")),C=t.template(d(m,".htm-group-resizer")),k={id:"rowSelectorGroup",type:"fixed",columns:[{title:"",dataIndex:"row-selector",displayType:"rowSelector",align:"center",width:"40px",readOnly:!0,draggable:!1}]},L=function(t){this.widget=t,this.options=t.options,this.$el=this.options.el,this.options.selectionMode==="check"&&this.options.columns.groups.unshift(k),this.config=t.config,this.options.layout.waffers.unshift({id:"headers",type:"fixed",height:30}),this.pseudoScrollers={vertical:{},horizontal:{}},this.$waffers={},this.viewports={},this.rowDragTimeout=0,this.resizers={group:{},waffer:{}},this.rowDragTimeout=0,this.$grid=g.clone(),this.columnDefinitions={},this.selectionModel=new r(this),this.columnResizer=new i(this),this.rowMover=a(this),this.find=p(this),this.columnMover=new s(this),this.contextMenu=c(this),this.columnMenu=h(this),this.virtualRows={},this.currentEditor=null,this.$cellEditor=e()};return e.extend(L.prototype,{remove:function(){this.$grid.empty(),this.$el.empty(),this.$el.remove()},init:function(){var e=this;e.generateColumnDefinitions(e.options.columns.groups,e.config.groups);var n;t.extend(e.config.waffers,e.options.layout.waffers),t.each(e.config.waffers,function(t){t.prev=n,n!=null&&(n.next=t),n=t,e.virtualRows[t.id]={displayTop:0,displayBottom:10,visibleRows:0,renderedTop:-1,renderedBottom:-1,records:[]}}),e.firstWaffer=t.first(e.config.waffers),e.widget.element.append(e.$grid),e.createWaffers(),e.generateViewports(),e.createColumns(),e.createWafferHeaders(),e.initListeners()},createWafferHeaders:function(){var e=this;t.each(e.config.waffers,function(t){if(t.id!=="headers"){var n=t.header;n!=null&&(e.createHeaderRow(t.id,n.title),e.virtualRows[t.id].headerRow=!0)}})},createHeaderRow:function(n,r){var i=this,s=i.config.groups;t.each(s,function(t){var s=e(b({id:"header",groupId:t.id})),o=e('<th class="pgbu-cell"></th>');o.attr("colspan",t.columns.length),t.id!=="rowSelectorGroup"&&o.text(r),s.append(o),i.viewports[n][t.id].$thead.append(s)})},initListeners:function(){var n=this;n.$grid.on("focus",e.proxy(l.focus,n)()),n.$grid.on("keyup",e.proxy(l.keyup,n)()),n.$grid.on("keydown",e.proxy(l.keydown,n)()),n.$grid.on("mousedown",e.proxy(l.mousedown,n)()),n.$grid.on("change",e.proxy(l.change,n)()),n.$grid.on("dblclick",e.proxy(l.doubleClick,n)()),n.$grid.on("contextmenu",e.proxy(l.contextMenu,n)()),n.$grid.on("scroll",e.proxy(l.scroll,n)()),t.each(n.resizers.group,function(e){e.$selector.on("mousedown",function(){return n.resizeGroup(e),!1})});var r=n.options.scrollbar.rowScrollHeight;t.each(n.pseudoScrollers.vertical,function(i,s){var o=n.$waffers[s],u=t.throttle(function(){var t=i.$scroller.scrollTop(),r=Math.round(t/v),o=Math.ceil(t/v);o===n.virtualRows[s].records.length-n.virtualRows[s].visibleRows?n.virtualRows[s].displayTop=o:n.virtualRows[s].displayTop=r,n.renderWaffer(s),n.closeEditor(!0)&&(n.$cellEditor=e())},50);i.$scroller.on("scroll",u),o.mousewheel(function(e,t,n,s){var o=0;s>0?o=-r:s<0&&(o=r);if(o!==0)return i.$scroller.scrollTop(i.$scroller.scrollTop()+o),!1})}),t.each(n.pseudoScrollers.horizontal,function(e,t){var r=n.viewports["$group-"+t].find("table");e.$scroller.scroll(function(){r.css("left",-e.$scroller.scrollLeft()),n.closeEditor(!0)})}),n.viewports["$waffer-"+t.first(n.config.waffers).id].find(".col-resize-anchor").on("mousedown",function(t){return n.columnResizer.initColumnResize(e(this).parent("th"),t.clientX),!1})},createWaffers:function(){var n=this,r=e();t.each(n.config.waffers,function(t){var i;t.type==="fixed"?i=e(T(t)):(i=e(x(t)),r=r.add(n.createPseudoScroller("vertical",t))),i.data("waffer",t),n.$grid.append(i),n.$waffers[t.id]=i});var i=N.clone();n.$grid.find(".waffer-flex").last().after(i),n.$grid.append(r),n.$scrollShims={$bottom:i.filter(".bottom-scroll-shim"),$right:i.filter(".right-scroll-shim")}},createPseudoScroller:function(t,n){var r=this,i=e(S({type:t,id:n.id}));return r.pseudoScrollers[t][n.id]={$content:i.find(".empty-content"),$scroller:i},i},generateViewports:function(){var n=this;t.each(n.config.waffers,function(t){n.viewports["$waffer-"+t.id]=e(),n.viewports[t.id]={}}),t.each(n.config.groups,function(r,i){n.viewports["$group-"+r.id]=e(),t.each(n.config.waffers,function(t){var i={};i.type=r.type,i.group=r.id,i.waffer=t.id,i.$viewport=e(y(i)),i.$table=i.$viewport.find("table"),i.$tbody=i.$table.find("tbody"),i.tbody="",i.$thead=i.$table.find("thead"),i.thead=[],i.$tfoot=i.$table.find("tfoot"),i.tfoot=[],i.groupConfig=r,i.wafferConfig=t,n.viewports[t.id][r.id]=i,n.viewports["$waffer-"+t.id]=n.viewports["$waffer-"+t.id].add(i.$viewport),n.viewports["$group-"+r.id]=n.viewports["$group-"+r.id].add(i.$viewport),i.$viewport.data("viewport",i),n.$waffers[t.id].append(i.$viewport)}),r.type==="flex"&&(n.$grid.append(n.createPseudoScroller("horizontal",r)),n.$grid.append(n.createGroupResizer(r,i))),++i});var r=t.last(t.keys(n.resizers.group));if(r!=null){var i=n.resizers.group[r];i!=null&&(i.$selector.remove(),delete n.resizers.group[r])}},createGroupResizer:function(t){var n=this,r={};return r.$selector=e(C(t)),r.group=t,n.resizers.group[t.id]=r,r.$selector},generateColumnDefinitions:function(n,r){var i=null,s=this,o={};e.extend(!0,o,{},n),t.each(o,function(e){e.prev=i,i!=null&&(i.next=e),i=e;for(var t=0;t<e.columns.length;++t){var n=e.columns[t];e.columns[t]=n=f(n),s.columnDefinitions[n.dataIndex]=n}r.push(e)})},createColumns:function(){var n=this;t.each(n.config.groups,function(r){t.each(n.config.waffers,function(i){var s=n.viewports[i.id][r.id];s.$headerRow=e("<tr></tr>").appendTo(s.$thead),t.each(r.columns,function(r){if(r.visible)if(i.id==="headers"){var o=e();if(r.dataIndex==="row-selector")o=e(r.renderer.thTemplate({dataIndex:r.dataIndex,width:r.width,tooltip:r.tooltip})),o.find('input[type="checkbox"]').on("change",function(r){var i=e(this),s=[];for(var o=0;o<n.config.waffers.length;o++)s=t.union(n.virtualRows[n.config.waffers[o].id].records,s);return n.widget.checkRows(s,i.is(":checked")),!1});else{var u="align-"+(r.headerAlign||"left");o=e(w({dataIndex:r.dataIndex,title:r.title,width:r.width,align:u,tooltip:r.tooltip})),r.resize&&o.append('<div class="col-resize-anchor"></div>')}s.$headerRow.append(o);var a=0;o.on("mousedown",function(t){var r=e(this);return a=setTimeout(function(){var e=r.closest("th"),i=n.columnDefinitions[e.attr("data-index")];i.draggable&&n.columnMover.initColumnDrag(e,r.closest("div.viewport").data("viewport"),t.clientX)},200),!1}),o.on("mouseup",function(e){clearTimeout(a)}),o.on("click",function(t){var r=e(this);n.closeEditor(),n.closeMenus();var i=n.columnDefinitions[r.attr("data-index")];if(i.dataIndex!=="row-selector"&&i.sortable)return n.widget.sortRows(i.dataIndex,t.ctrlKey),!1}),o.on("contextmenu",function(t){var r=e(t.target);n.columnMenu.render(r.closest("th"),t,!1),t.stopPropagation(),t.preventDefault()}),s.$headerRow.append(o)}else s.$headerRow.append(E(r))})})})},openEditor:function(n,r,i,s){var o=this;if(!o.options.editable||t.contains(o.widget.store.getRecordAttributes(o.widget.store.getRecord(r)).readOnly,i))return;var u=e();if(s!=null){var a=e(s.target);u=a.closest("td")}else this.widget.selectCell(r,i,"middle",!1),u=this.selectionModel.focus.$td;var f=o.columnDefinitions[u.attr("data-index")];if(!f.readOnly&&f.displayType!=="check"){u.addClass("editing");var l=u.find(".cell-renderer");l.hide();var c=f.editor.initialize({grid:o,$cell:u,data:n,column:f,onPersistFn:function(e){o.widget._cellUpdated(u.parent().attr("data-id"),u.attr("data-index"),e)},onCloseFn:function(){u.removeClass("editing"),l.show(),o.currentEditor=null,o.$grid.get(0).focus()}});o.currentEditor=f.editor,o.$cellEditor=c;var h=null,p=!1;s!=null&&(h=s.keyCode,p=s.shiftKey),f.editor.show(h,p)}},closeEditor:function(e){return this.$cellEditor.length&&this.currentEditor!=null&&!this.currentEditor.getCommitStarted()?this.currentEditor.commit():!0},closeMenus:function(){this.columnMenu.destroy(),this.contextMenu.isOpen()&&this.contextMenu.destroy()},buildVirtualRow:function(e,t){return t==null&&(t=this.widget._getRecordWaffer(e)),this.viewports["$waffer-"+t].find('tbody tr[data-id="'+e+'"]')},cutRecords:function(e){this.clearCopyFlags(),this.applyClassToRecords(e,"row-cut")},copyRecords:function(e){this.clearCopyFlags(),this.applyClassToRecords(e,"row-copied")},clearCopyFlags:function(){this.$grid.find(".row-cut").removeClass("row-cut"),this.$grid.find(".row-copied").removeClass("row-copied")},applyClassToRecords:function(e,n){var r=this;t.each(e,function(e){var t=r.widget._getRecordWaffer(e),i=r.virtualRows[t],s=r.getRecordIndex(e,t);s>=i.displayTop&&s<=i.displayBottom&&r.buildVirtualRow(e).addClass(n)})},clearSelection:function(){this.$grid.find(".row-selected").removeClass("row-selected"),this.$grid.find(".cell-selected").removeClass("cell-selected")},selectRow:function(e,t,n){t==null&&(t=!0),t?e.addClass("row-selected"):e.is(".row-selected")&&e.removeClass("row-selected"),n!=null&&this.selectionModel.cell.selectCell(e.find('td[data-index="'+n+['"]']))},selectRecords:function(e,n,r){var i=this;t.each(e,function(e){var t=i.widget._getRecordWaffer(e),s=i.virtualRows[t],o=i.getRecordIndex(e,t);o>=s.displayTop&&o<=s.displayBottom&&i.selectRow(i.buildVirtualRow(e),n,r)})},checkRow:function(e,t){t?e.addClass("row-checked"):e.is(".row-checked")&&e.removeClass("row-checked"),e.find('td[data-index="row-selector"] input').prop("checked",t)},checkRecords:function(e,n){var r=this;t.each(e,function(e){var t=r.widget._getRecordWaffer(e),i=r.virtualRows[t],s=r.getRecordIndex(e,t);s>=i.displayTop&&s<=i.displayBottom&&r.checkRow(r.buildVirtualRow(e),n)})},selectHeaderCell:function(e){this.selectionModel.cell.selectHeader(this.viewports["$waffer-headers"].find("thead tr"),e)},moveRecords:function(e,n){var r;this.options.debug&&(r=Date.now());var i=this;this.deleteRecords(e,!0),t.each(e,function(e){i.addRecord(e,n,!1,!1)}),this.options.debug&&this.widget._trigger("performance-debug",null,{start:r,end:Date.now(),name:"move-Records",type:"view",info:e})},deleteRecords:function(e,n){var r;this.options.debug&&(r=Date.now());var i=this,s={},o=!1;t.each(e,function(e){var t=i.widget._getRecordWaffer(e),n=i.virtualRows[t],r=i.getRecordIndex(e,t);r<n.displayTop?n.displayTop--:r>=n.displayTop&&r<=n.displayBottom&&(i.deleteRow(e,t),n.renderedBottom--),s[t]=!0,n.records.splice(r,1),i.selectionModel.focus.recordId===e&&(o=!0)}),t.each(t.keys(s),function(e){var t=i.virtualRows[e];t.displayTop<0&&(t.displayTop=0),t.displayTop+t.visibleRows>t.records.length&&(t.displayTop=t.records.length-t.visibleRows),i.renderWaffer(e);if(i.selectionModel.focus.wafferId===e&&o&&!n){var r=i.selectionModel.focus.recordIndex;r>=t.records.length&&(r=t.records.length-1);if(r>=0){var s=t.records[r];i.widget.selectCell(s)}else i.widget.clearSelection()}}),this.options.debug&&this.widget._trigger("performance-debug",null,{start:r,end:Date.now(),name:"delete-Records",type:"view",info:e})},deleteRow:function(e,t){var n=this.buildVirtualRow(e,t);n.remove()},attachRows:function(e,n,r,i,s){var o=this,u=o.viewports["$waffer-"+e].find("tbody");switch(i){case"replace":u.empty();break;case"append":u.find("tr:lt("+s+")").remove();break;case"prepend":u.find("tr:gt("+s+")").remove();break;case"insert":var a=this.virtualRows[e].visibleRows-r.length;u.find("tr:gt("+a+")").remove()}t.each(o.config.groups,function(u){var a=t.pluck(r,u.id).join(" ");switch(i){case"replace":case"append":o.viewports[e][u.id][n].append(a);break;case"prepend":o.viewports[e][u.id][n].prepend(a);break;case"insert":o.viewports[e][u.id][n].children().eq(s).after(a)}})},replaceRow:function(t,n){var r=this;n.each(function(){var n=e(this),i=e(t[n.attr("data-group-id")]);if(n.is(".row-selected")){n.before(i),n.remove();var s=n.find("td.cell-selected");s.length&&r.selectionModel.cell.selectCell(i.find('td[data-index="'+s.attr("data-index")+'"]'))}else n.before(i),n.remove()})},populateRecords:function(e,t){var n=this.virtualRows[t.waffer];n.records.push(e)},addRecord:function(e,t,n){var r;this.options.debug&&(r=Date.now());var i=this.virtualRows[t.waffer],s=this.getRecordIndex(t.previousRecord,t.waffer);s<0&&t.previousRecord!==-1&&t.previousRecord!=null&&(this.selectionModel.focus.recordIndex!=null?s=this.selectionModel.focus.recordIndex:s=i.records.length-1),i.records.splice(s+1,0,e);if(s<0&&i.displayTop>0||s>=0&&s<i.displayTop||s>=i.displayBottom)s<i.displayTop&&i.displayTop++,n&&(i.displayTop=s+1,i.recordsModified=!0);else{var o=[this.makeRow(e,t.waffer)];if(s===-1&&i.displayTop===0)this.attachRows(t.waffer,"$tbody",o,"prepend",i.visibleRows-1),i.records.length<=i.visibleRows&&(i.renderedBottom++,i.displayBottom++);else if(s===i.records.length-2){i.renderedBottom++,i.displayBottom++;var u=1;i.visibleRows>=i.displayBottom?u=0:(i.displayTop++,i.renderedTop++),this.attachRows(t.waffer,"$tbody",o,"append",u)}else this.attachRows(t.waffer,"$tbody",o,"insert",s-i.displayTop),i.records.length<i.visibleRows&&i.renderedBottom++}this.options.debug&&this.widget._trigger("performance-debug",null,{start:r,end:Date.now(),name:"add-Record",type:"view",info:e})},renderWaffer:function(e,t){var n;this.options.debug&&(n=Date.now());var r=this,i=this.virtualRows[e];i.displayTop<0&&(i.displayTop=0);var s=i.displayTop+i.visibleRows+1;s>=i.records.length&&(s=i.records.length),i.displayBottom=s;if(i.renderedTop===i.displayTop&&!t&&i.renderedBottom===i.displayBottom)return;var o=i.displayTop,u=s,a=0,f="";t||i.displayTop>=i.renderedBottom||i.displayBottom<=i.renderedTop?f="replace":i.displayTop>i.renderedTop&&i.displayTop<i.renderedBottom||i.displayBottom>i.renderedBottom?(o=i.renderedBottom,a=i.displayTop-i.renderedTop,f="append"):i.displayBottom<=i.renderedBottom&&i.displayTop<i.renderedTop&&(u=i.renderedTop,a=i.displayBottom-i.renderedTop-1,f="prepend");var l=[];for(var c=o;c<u;c++)l.push(r.makeRow(i.records[c],e));r.attachRows(e,"$tbody",l,f,a),this.virtualRows[e].renderedTop=i.displayTop,this.virtualRows[e].renderedBottom=i.displayBottom,i.recordsModified=!1,this.options.debug&&this.widget._trigger("performance-debug",null,{start:n,end:Date.now(),name:"render-Waffer",type:"view"})},makeRow:function(e,n){var r=this.widget.store.getRecord(e),i=this.widget._getRecordAttributes(r),s=this,o={},u=s.widget._getRecordId(r),a=s.config.groups,f=s.config.groups.length,l=0,c=null;for(;l<f;l++){c=a[l];var h=s.options.rows.classes(r,c.id,n),p="";if(h.length||i.newRow||i.selected||i.cut||i.copied||i.checked)p='class="'+(i.newRow?"row-new ":""),p+=i.selected?"row-selected ":"",p+=i.cut?"row-cut ":"",p+=i.copied?"row-copied ":"",p+=i.checked?"row-checked ":"",p+=h+'"';var d=c.columns,v=null,m=d.length,g=0,y=c.id,b="<tr "+p+s.options.rows.attributes(r,c.id,n)+' data-id="'+u+'" data-group-id="'+y+'">';for(;g<m;g++){v=d[g];if(v.visible){var w=this.widget.store.getValueFromRecord(r,v.dataIndex);v.dataIndex==="row-selector"&&(w=i.checked),b+=v.renderer.create(v,r,w,t.contains(i.modified,v.dataIndex),v.readOnly||t.contains(i.readOnly,v.dataIndex),i.focused&&v.dataIndex===s.selectionModel.focus.column)}}b+="</tr>",o[c.id]=b}return o},attachDOMTables:function(e,t,n){for(var r=0;r<this.config.waffers.length;r++)for(var i=0;i<this.config.groups.length;i++){var s=this.viewports[this.config.waffers[r].id][this.config.groups[i].id];e?s[n].after(s[t]):s[t].detach()}},clearTables:function(){var e;this.options.debug&&(e=Date.now());for(var t=0;t<this.config.waffers.length;t++){for(var n=0;n<this.config.groups.length;n++){var r=this.viewports[this.config.waffers[t].id][this.config.groups[n].id];r.$tbody.empty(),r.$tfoot.empty()}this.virtualRows[this.config.waffers[t].id].records=[]}this.options.debug&&this.widget._trigger("performance-debug",null,{start:e,end:Date.now(),name:"clear-Tables",type:"view"})},resetHeaders:function(){for(var e=0;e<this.config.waffers.length;e++)for(var t=0;t<this.config.groups.length;t++){var n=this.viewports[this.config.waffers[e].id][this.config.groups[t].id];n.$thead.empty()}this.createColumns()},cleanModifiedRows:function(){this.$grid.find("td.modified").removeClass("modified"),this.$grid.find("tr.deleted").remove(),this.$grid.find("tr.new").removeClass("new")},switchColumnVisibilty:function(e){var n=this;e.visible=!e.visible,n.resetHeaders(),t.each(this.config.waffers,function(e){e.id!=="headers"&&n.renderWaffer(e.id,!0)})},getColumnVisibleCount:function(){var e=0;return t.each(this.columnDefinitions,function(t){t.dataIndex!=="row-selector"&&t.visible===!0&&e++}),e},getRecordOrder:function(e){return t.clone(this.virtualRows[e].records)},applySortOrder:function(e,t){var n=this.virtualRows[e];n.originalOrder==null&&(n.originalOrder=n.records),n.records=t},clearSort:function(){var e=this;t.each(this.config.waffers,function(t){var n=e.virtualRows[t.id],r=!1;n.originalOrder!=null&&(n.records=e.virtualRows[t.id].originalOrder,n.originalOrder=null,r=!0),e.renderWaffer(t.id,r)})},resize:function(){var e;this.options.debug&&(e=Date.now());var t,n,r=this.$grid.parent();this.config.width.indexOf("%")===-1?t=parseFloat(this.config.width):t=r.width()*(parseFloat(this.config.width)/100),this.config.height.indexOf("%")===-1?n=parseFloat(this.config.height):n=r.height()*(parseFloat(this.config.height)/100);var i=parseInt(t,10),s=parseInt(n,10);this.$grid.css("width",i),this.$grid.css("height",s);var o=u.calculateWafferHeights(this,s,!1),a=u.calculateGroupWidths(this,i,o);a?(u.calculateWafferHeights(this,s,a),this.$scrollShims.$bottom.css("display","block")):this.$scrollShims.$bottom.css("display","none"),o?this.$scrollShims.$right.css("display","block"):this.$scrollShims.$right.css("display","none"),u.resizeWaffersFn(this,o),u.resizeGroupsFn(this,s),this.options.debug&&this.widget._trigger("performance-debug",null,{start:e,end:Date.now(),name:"resize",type:"view"})},resizeGroup:function(n,r){var i=this.$grid.offset().left;n.$selector.addClass("dragging"),this.$grid.on("mousemove.group-resize",t.throttle(u.onGroupDragFn(n,i),20)),e(document.body).on("mouseup.group-resize",u.resizeDraggedGroupFn(this,n)),u.moveResizeBarFn(n,r-i)},scrollFocusIntoView:function(){var e=this.selectionModel.focus.$td,t=this.selectionModel.focus.viewport,n=this.pseudoScrollers.horizontal[t.group];if(n!=null){var r;this.options.debug&&(r=Date.now());var i=0;e.is("th")?i=parseInt(e.attr("width"),10):i=parseInt(t.$thead.find('th[data-index="'+e.attr("data-index")+'"]').attr("width"),10);var s=t.$viewport.width(),o=t.$table.position().left+e.position().left+i,u=o-s;u>0?n.$scroller.scrollLeft(n.$scroller.scrollLeft()+u):o<i&&n.$scroller.scrollLeft(n.$scroller.scrollLeft()+o-i),this.options.debug&&this.widget._trigger("performance-debug",null,{start:r,end:Date.now(),name:"scroll-Focus-Into-View",type:"view"})}},renderFocus:function(e,n,r,i){var s;this.options.debug&&(s=Date.now());if(e!=null){var o=this.virtualRows[n];this.selectionModel.focus.recordId=e,this.selectionModel.focus.wafferId=n,o[this.selectionModel.focus.recordIndex]!==e&&(this.selectionModel.focus.recordIndex=t.indexOf(o.records,e)),r!=null&&(this.selectionModel.focus.column=r);var u=this.renderRecord(this.selectionModel.focus.recordId,this.selectionModel.focus.wafferId,i,this.selectionModel.focus.recordIndex);return this.options.debug&&this.widget._trigger("performance-debug",null,{start:s,end:Date.now(),name:"render-focus",type:"view"}),u}return!1},getRecordIndex:function(e,n){n==null&&(n=this.widget._getRecordWaffer(e));var r=this.virtualRows[n];for(var i=r.displayTop;i<r.records.length;++i)if(r.records[i]===e)return i;return t.indexOf(r.records,e)},renderRecord:function(e,t,n,r){var i;this.options.debug&&(i=Date.now());var s=this.virtualRows[t];r==null&&(r=this.getRecordIndex(e,t));if(r>=s.displayTop&&r<=s.displayTop+s.visibleRows-1)return!1;var o=r;return n==null||n==="top"?o=r:n==="middle"?o=r-Math.floor(s.visibleRows/2):n==="bottom"&&(o=r-s.visibleRows+1),o+s.visibleRows>s.records.length&&(o=s.records.length-s.visibleRows),o<0&&(o=0),s.displayTop=o,this.renderWaffer(t),this.options.debug&&this.widget._trigger("performance-debug",null,{start:i,end:Date.now(),name:"render-record",type:"view"}),!0},updateWafferScrollbar:function(e){var t=this.virtualRows[e];this.pseudoScrollers.vertical[e].$scroller.scrollTop(t.displayTop*v)}}),L}),define("gridapi.grid/storeWrapper",["gridapi.jquery","gridapi.underscore"],function(e,t){var n={},r=function(e,t){this.store=e,this.options=t.options,this.widget=t;var n=this.options.storeFns;this.group=n.group||this.group,this.sort=n.sort||this.sort,this.filter=n.filter||this.filter,this.getRecord=n.getRecord||this.getRecord,this.getRecords=n.getRecords||this.getRecords,this.newRecord=n.newRecord||this.newRecord,this.cutRecords=n.cutRecords||this.cutRecords,this.copyRecords=n.copyRecords||this.copyRecords,this.deleteRecords=n.deleteRecords||this.deleteRecords,this.attachListeners=n.attachListeners||this.attachListeners,this.placeRecord=n.placeRecord||this.placeRecord,this.iterateStore=n.iterateStore||this.iterateStore,this.updateRecord=n.updateRecord||this.updateRecord,this.commit=n.commit||this.commit,this.reset=n.reset||this.reset,this.deletedRecords=[],this.getRecordAttributes=n.getRecordAttributes||this.getRecordAttributes,this.checkRecordPermissions=n.checkRecordPermissions||this.checkRecordPermissions,this.updateRecordPlacement=n.updateRecordPlacement||this.updateRecordPlacement,this.modified={},this.readOnly={},this.newRecords={}};return r.prototype={constructor:r,sort:function(e){return!1},group:function(e){return!1},filter:function(e){return!1},getRecord:function(e){return e<0?this.newRecords[e]:this.store[e]},getRecords:function(e){var n=[],r=this;return t.each(e,function(e){n.push(r.getRecord(e))}),n},newRecord:function(e){var n={};return n[this.widget.options.rows.id]=""+ -(t.uniqueId()+1),n.title="You should probably overwrite this method !!",n.type=e,n},addRecords:function(e){var n=this,r=[];t.each(e,function(e){var i=t.indexOf(n.deletedRecords,e);i!==-1&&(delete n.deletedRecords[i],r.push(e)),e[n.widget.options.rows.id]<0&&(n.newRecords[e[n.widget.options.rows.id]]=e)}),this.store.push(t.difference(e,r)),this.widget._recordsAdded(e)},cutRecords:function(e,t){},copyRecords:function(n,r){var i=this,s=[];return t.each(n,function(n){var r=e.extend(!0,i.newRecord(),n);r.id=""+ -t.uniqueId(),i.store.push(r),s.push(r)}),s},deleteRecords:function(e){this.deletedRecords=t.union(this.deletedRecords,e),this.widget._recordsRemoved(e)},attachListeners:function(){},placeRecord:function(e){var t={waffer:e.__location__,table:"$tbody",previousRecord:e.parentId};if(t.waffer==null||t.waffer==="")t.waffer=this.widget.defaultWaffer;return t},iterateStore:function(e,t,n){for(var r=0;r<this.store.length;++r)e.call(t,this.store[r],n)},updateRecord:function(e,t,n){e[t]=n,this.modified[e.id]!=null?this.modified[e.id].push(t):this.modified[e.id]=[t],this.widget._recordUpdated(e,t,n,!0)},getValueFromRecord:function(e,t){return e[t]},commit:function(){this.widget.repopulate(),this.modified={},this.readOnly={}},reset:function(){this.widget.repopulate(),this.modified={},this.readOnly={}},checkRecordPermissions:function(e){return["description"]},moveRecords:function(e,t){for(var n=0;n<e.length;++n)n===0?t!=null&&(e[n].parentId=t.id):e[n].parentId=e[n-1].id,t!=null&&(e[n].__location__=t.__location__)},getRecordAttributes:function(e){var t={newRow:!1,modified:[],readOnly:[]};this.modified[e.id]!=null&&(t.modified=this.modified[e.id]);if(this.readOnly[e.id]!=null)t.readOnly=this.readOnly[e.id];else{var n=this.checkRecordPermissions(e);t.readOnly=n,this.readOnly[e.id]=n}return e.id<0&&(t.newRow=!0),t},updateRecordPlacement:function(e,t,n){t!==n&&(e.__location__=n)}},r}),define("gridapi.grid/filterController",["gridapi.jquery","gridapi.underscore"],function(e,t){function n(e){var t=new Date(e),n=t.getHours();return t.getTime()-n*36e5}return function(e){return{triggerFilter:function(t,n){var r={};switch(t){case"integer":case"float":case"date":r.filterType=n.filterType;break;case"enum":r.selectMultiple=n.selectMultiple}r.dataType=t,r.value=n.value,e.widget.filterRows(e.columnDefinitions[n.columnId],e.columnDefinitions[n.columnId].filterable,r)},deleteFilter:function(t){e.widget.filterRows(t,!1,{})},_generateFilter:function(e,r){switch(e.dataType){case"picker":return function(e){var n=[];t.each(e,function(e){n.push(e.id)});for(var i=0;i<r.value.length;i++)for(var s=0;s<n.length;s++)if(r.value[i].id===n[s])return!0;return!1};case"integer":return r.filterType==="greater"?function(e){return parseInt(e,10)<parseInt(r.value,10)?!0:!1}:r.filterType==="lesser"?function(e){return parseInt(e,10)>parseInt(r.value,10)?!0:!1}:r.filterType==="range"?function(e){return parseInt(e,10)<parseInt(r.value.greater,10)&&parseInt(e,10)>parseInt(r.value.lesser,10)?!0:!1}:function(e){return parseInt(e,10)===parseInt(r.value,10)?!0:!1};case"float":return r.filterType==="greater"?function(e){return parseFloat(e)<parseFloat(r.value)?!0:!1}:r.filterType==="lesser"?function(e){return parseFloat(e)>parseFloat(r.value)?!0:!1}:r.filterType==="range"?function(e){return parseFloat(e)<parseFloat(r.value.greater)&&parseFloat(e)>parseFloat(r.value.lesser)?!0:!1}:function(e){return parseFloat(e)===parseFloat(r.value)?!0:!1};case"string":case"large":return function(e){return e.toLowerCase().indexOf(r.value.toLowerCase())!==-1?!0:!1};case"date":return r.filterType==="greater"?function(e){return n(e)<r.value.getTime()?!0:!1}:r.filterType==="lesser"?function(e){return n(e)>r.value.getTime()?!0:!1}:r.filterType==="range"?function(e){var t=n(e);return t>r.value.lesser.getTime()&&t<r.value.greater.getTime()?!0:!1}:function(e){return n(e)===r.value.getTime()?!0:!1};case"enum":return r.selectMultiple===!0?function(e){for(var n=0;n<e.length;n++)if(t.indexOf(r.value,parseInt(e[n],10))!==-1)return!0;return!1}:function(e){return t.indexOf(r.value,parseInt(e,10))===-1?!1:!0}}},_updateFilterConfig:function(e,t,n){var r={key:e,args:t};return n!=null&&(r=n),r.filter=this._generateFilter(e,t),r}}}}),define("gridapi",["gridapi.jquery","gridapi.underscore","gridapi.grid/gridView","gridapi.grid/storeWrapper","gridapi.grid/sorters","gridapi.grid/i18n/localizedStrings","gridapi.grid/filterController","gridapi.jqueryui","gridapi.mousewheel","oui","pgbucoreapi"],function(e,t,n,r,i,s,o,u,a){var f={determineWafferPercents:function(e){var n=0,r=0,i=t.filter(e,function(e){return e.type==="flex"});t.each(i,function(e){e.percent!=null&&(e.percent=parseInt(e.percent,10),n+=e.percent,r++)});if(i.length>r){var s=(100-n)/i.length-r;t.each(i,function(e){e.percent==null&&(e.percent=s)})}}};e.widget("pgbu.grid",{options:{columns:{},createRow:e.noop,filter:{},contextMenu:{enabled:!1,populate:e.noop},columnMenu:{enabled:!1,columnToggleMenu:{}},editable:!1,debug:!1,layout:{width:"500px",height:"500px",waffers:[],autoResize:!0},scrollbar:{extraHeight:15,extraWidth:15,rowScrollHeight:31},borders:{size:2},sizing:{minColumnWidth:40,minGroupWidth:100},rows:{id:"id",draggable:!1,classes:function(e,t,n){return""},attributes:function(e,t,n){return""}},storeFns:{},selectionMode:"default",multiSelect:!0,locale:s},_create:function(){var r=this;this.options.layout.autoResize&&e(window).on("resize.grid",t.debounce(function(){r.resize()},300)),this.widgetEventPrefix="grid-",this.eventNamespace="grid-",this.config={waffers:[],groups:[],height:this.options.layout.height,width:this.options.layout.width,filter:this.options.filter,contextMenu:this.options.contextMenu,sortBy:[]},this.idKey=this.options.rows.id,this.view=new n(this),this.view.init(),this.filterController=new o(this.view),this.options.selectionMode==="check"&&(this.options.multiSelect=!1),this.selection={records:[]},this.focus={record:null,column:null},this.checkedRecords=[],this.clipboard={records:[],mode:"cut"},this.paging={startIndex:0,pageSize:50,page:0,loaded:150,totalRows:300},this.defaultWaffer=t.filter(this.config.waffers,function(e){return e.type==="flex"})[0].id,this.defaultWaffer==null&&(this.defaultWaffer=this.config.waffers[0].id),this.undoStack=[],this.redoStack=[],f.determineWafferPercents(this.config.waffers);var i=function(){r._trigger("is-dirty")};this.element.bind("grid-cell-updated",i),this.element.bind("grid-rows-added",i),this.element.bind("grid-rows-deleted",i),this.element.bind("grid-rows-pasted",i),this.view.resize()},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){this.view.closeEditor(),this.view.closeMenus(),this.element.children().each(function(){e(this).remove()}),this.element.empty(),this._tearDownTriggers(),delete this.store,delete this.view,e.Widget.prototype.destroy.call(this)},_tearDownTriggers:function(){this.element.unbind("grid-cell-updated"),this.element.unbind("grid-rows-added"),this.element.unbind("grid-rows-deleted"),this.element.unbind("grid-rows-pasted"),e(window).off("resize.grid"),this.element.off(this.widgetEventPrefix)},_getRecordId:function(e){return this.store.getValueFromRecord(e,this.idKey)},_cellUpdated:function(e,n,r){var i=this.store.getRecord(e);this._pushUndoAction({type:"edit",key:n,data:t.clone(this.store.getValueFromRecord(i,n)),record:i}),this.store.updateRecord(i,n,r)},_recordUpdated:function(e,t){var n=this._getRecordId(e);this._updateRow(e),this._trigger("cell-updated",null,[n,t,e])},_recordsAdded:function(e,n){var r=this,i=[];t.each(e,function(e){var s=r.store.placeRecord(e);n==null&&(n=!0),t.contains(i,s.waffer)||i.push(s.waffer),r._addRecordToView(e,{location:s,bulk:!1,select:n})}),t.each(i,function(e){r.view.renderWaffer(e)}),this.view.resize(),n&&this.selectCell(this._getRecordId(t.last(e))),this._trigger("rows-added",null,e)},_recordsRemoved:function(e){var n=this,r=[];t.each(e,function(e){r.push(n._getRecordId(e))}),n.view.deleteRecords(r),n.view.resize(),n.selection.records=t.difference(n.selection.records,e),t.contains(e,n.focus.record)&&(n.focus.record=null),n.checkedRecords=t.difference(n.checkedRecords,e),n._trigger("rows-deleted",null,e)},newRow:function(){var e;this.options.debug&&(e=Date.now());if(this._trigger("before-new",null,{args:arguments,selection:this.selection.records})===!1)return;var t=this.store.newRecord.apply(this.store,arguments);this._pushUndoAction({records:[t],type:"new"}),this.store.addRecords([t]),this.options.debug&&this._trigger("performance-debug",null,{start:e,end:Date.now(),name:"new-row",type:"widget"})},deleteRows:function(){var e=this.getSelection();if(e.length){var n;this.options.debug&&(n=Date.now());if(this._trigger("before-delete-selected",null,e)===!1)return;this.store.deleteRecords(e),this._pushUndoAction({type:"delete",records:t.clone(e)}),this.options.debug&&this._trigger("performance-debug",null,{start:n,end:Date.now(),name:"delete-rows",type:"widget"})}},editRow:function(e,t,n){var r=this.store.getRecord(e),i=this.store.getValueFromRecord(r,t);this.view.openEditor(i,e,t,n)},selectCell:function(e,t,n,r){var i;this.options.debug&&(i=Date.now()),e!=null?this.focus.record=this.store.getRecord(e):this.focus.record!=null?e=this._getRecordId(this.focus.record):(e=this.view.virtualRows[this.config.waffers[1].id].records[0],e!=null?this.focus.record=this.store.getRecord(e):this.focus.record=null),t==null&&(this.focus.columnId!=null?t=this.focus.columnId:t=this.config.groups[0].columns[0].dataIndex),this.focus.columnId=t;if(e!=null){var s=this.store.placeRecord(this.focus.record).waffer,o=this.view.renderFocus(e,s,t,n);this.selectRows([e],r,null,t),this.view.scrollFocusIntoView(),o&&this.view.updateWafferScrollbar(s)}this.options.debug&&this._trigger("performance-debug",null,{start:i,end:Date.now(),name:"select-cell",type:"widget",info:"Record:  "+e+" Col: "+t})},selectHeaderCell:function(e){this.clearSelection(),this.focus.record=null,this.view.selectHeaderCell(e),this.view.scrollFocusIntoView()},selectRows:function(e,n,r,i){var s=this,o;s.options.debug&&(o=Date.now());var u=this.store.getRecords(e);if(s._trigger("before-select-rows",null,u)===!1)return;if(e!=null&&e.length>0){(n==null||!n)&&(u.length!==this.selection.records.length||t.difference(u,this.selection.records).length)&&s.clearSelection(!0);var a=t.difference(u,this.selection.records);if(a.length>0){var f=[];t.each(u,function(e){s.selection.records.push(e),f.push(s._getRecordId(e))}),s.view.selectRecords(f,!0,i),s._trigger("rows-selected",r,[a,this.selection.records])}else i!=null&&s.view.selectRecords([e[0]],!0,i)}else s.clearSelection();s.options.debug&&s._trigger("performance-debug",null,{start:o,end:Date.now(),name:"select-rows",type:"widget",info:e})},deselectRows:function(e,n){var r=this,i;r.options.debug&&(i=Date.now());var s=r.store.getRecords(e);if(r._trigger("before-deselect-rows",null,s)===!1)return;if(e!=null&&e.length>0){var o=t.intersection(s,r.selection.records);t.each(o,function(e){r.view.selectRecords([r._getRecordId(e)],!1)}),r.selection.records=t.difference(r.selection.records,s),o.length>0&&r._trigger("rows-selected",n,[o,this.selection.records])}r.options.debug&&r._trigger("performance-debug",null,{start:i,end:Date.now(),name:"deselect-rows",type:"widget",info:e})},checkRows:function(e,n){var r=this;if(r.options.selectionMode==="check"){var i=this.store.getRecords(e);n==null||n?r.checkedRecords=t.union(r.checkedRecords,i):r.checkedRecords=t.difference(r.checkedRecords,i),r.view.checkRecords(e,n),r._trigger("rows-checked",null,[this.checkedRecords])}},getSelection:function(){switch(this.options.selectionMode){case"default":return this.selection.records;case"check":return this.checkedRecords}throw new Error("Selection mode is not set correctly")},clearSelection:function(e){this.selection.records=[],this.view.clearSelection(),e||this._trigger("rows-selected",null,[[],[]])},resize:function(e,t){this.view.resize()},setStore:function(e,t){var n;this.options.debug&&(n=Date.now()),t!=null?this.store=new t(e,this):this.store=new r(e,this),this.repopulate(),this.store.attachListeners(),this.options.debug&&this._trigger("performance-debug",null,{start:n,end:Date.now(),name:"set-store",type:"widget"})},reset:function(){if(this._trigger("before-reset")===!1)return;this.store.reset(),this._trigger("reset"),this._trigger("is-clean")},commit:function(){if(this._trigger("before-commit-grid")===!1)return;this.store.commit(),this._trigger("commit")},cleanRows:function(){this.view.cleanModifiedRows(),this._trigger("is-clean")},sortRows:function(e,n,r){var s=t.first(t.filter(this.config.sortBy,function(t){return t.key===e}));if(n==null||!n)this.config.sortBy=t.intersection(this.config.sortBy,[s]);s!=null?r!=null?s.order===r?this.config.sortBy=t.without(this.config.sortBy,s):(s.order=r,this.config.sortBy.length===1&&(this.reverseSortOrder=!0)):s.order==="asc"?(s.order="dsc",this.config.sortBy.length===1&&(this.reverseSortOrder=!0)):this.config.sortBy=t.without(this.config.sortBy,s):this.config.sortBy.push({key:e,order:r!=null?r:"asc",sorter:i[this.view.columnDefinitions[e].dataType]}),this.store.sort(this.config.sortBy)===!1&&this._sortRecords();var o=this.view.viewports["$waffer-"+t.first(this.config.waffers).id].find("thead th");o.removeClass("col-sort-asc").removeClass("col-sort-dsc"),t.each(this.config.sortBy,function(e){o.filter('th[data-index="'+e.key+'"]').addClass(e.order==="asc"?"col-sort-asc":"col-sort-dsc")}),this._trigger("view-updated",null,{action:"column-sort",sort:t.clone(this.config.sortBy)})},groupRows:function(e){var t=this,n;t.options.debug&&(n=Date.now()),this.store.group(e)===!1&&console.log("GROUPME"),t.options.debug&&t._trigger("performance-debug",null,{start:n,end:Date.now(),name:"group-rows",type:"widget",info:e})},filterRows:function(e,n,r){var i=this,s;i.options.debug&&(s=Date.now()),n?this.config.filter[e.dataIndex]=this.filterController._updateFilterConfig(e,r,this.config.filter[e]):delete this.config.filter[e.dataIndex],this.store.filter(this.config.filter)===!1&&(i.filters=[],t.each(this.config.filter,function(e){i.filters.push(e)}),this._filterRecords(),this._sortRecords()),this._trigger("view-updated",null,{action:"filter",filter:t.clone(this.config.filter)}),i.options.debug&&i._trigger("performance-debug",null,{start:s,end:Date.now(),name:"filter-rows",type:"widget",info:t.pluck(i.filter,"key")})},_filterRecord:function(e){var t=this,n=t.filters;for(var r=0;r<n.length;r++)if(!n[r].filter(t.store.getValueFromRecord(e,n[r].key.dataIndex)))return!1;return t._addRecordToView(e),!0},_filterRecords:function(){var e=this;e.view.attachDOMTables(!1,"$tbody"),e.view.clearTables(),e.store.iterateStore(this._filterRecord,this),e.view.resize(),t.each(e.config.waffers,function(t){e.view.renderWaffer(t.id,!0)}),e.view.attachDOMTables(!0,"$tbody","$thead",!0),e.selectCell()},undo:function(){var e=this.undoStack.pop();if(e!=null){var n=t.clone(e);switch(e.type){case"edit":n.data=t.clone(this.store.getValueFromRecord(e.record,e.key)),this.store.updateRecord(e.record,e.key,e.data);break;case"delete":this.store.addRecords(e.records);break;case"new":this.store.deleteRecords(e.records)}this.redoStack.push(n)}},redo:function(){var e=this.redoStack.pop();if(e!=null){var n=t.clone(e);switch(e.type){case"edit":n.data=t.clone(this.store.getValueFromRecord(e.record,e.key)),this.store.updateRecord(e.record,e.key,e.data);break;case"delete":this.store.deleteRecords(e.records);break;case"new":this.store.addRecords(e.records)}this._pushUndoAction(n,!1)}},repopulate:function(n,r,i){var s=this,o;s.options.debug&&(o=Date.now()),s.view.attachDOMTables(!1,"$tbody"),s.view.clearTables(),s.focus.record=null,s.focus.columnId=null;var u={bulk:!0},a={};e.extend(!0,a,u,i),s.store.iterateStore(this._addRecordToView,this,a),s.view.resize(),t.each(s.config.waffers,function(e){s.view.renderWaffer(e.id,!0)}),s.view.attachDOMTables(!0,"$tbody","$thead",!0),s.selectCell(n,r),s.options.debug&&s._trigger("performance-debug",null,{start:o,end:Date.now(),name:"repopulate",type:"widget",info:n+"-"+r})},cutRows:function(){var e=this;if(this.options.editable){var n=this.getSelection();if(n.length){if(this._trigger("before-cut-selected",null,n)===!1)return;var r;e.options.debug&&(r=Date.now()),this.clipboard.records=t.clone(n),this.clipboard.mode="cut";var i=[];t.each(n,function(t){i.push(e._getRecordId(t))}),this.view.cutRecords(i),this._trigger("rows-cut",null,[n]),e.options.debug&&e._trigger("performance-debug",null,{start:r,end:Date.now(),name:"cut-Rows",type:"widget",info:i})}else this._trigger("rows-selected",null,[this.selection.records])}},copyRows:function(){var e=this;if(this.options.editable){var n=this.getSelection();if(n.length){if(this._trigger("before-copy-selected",null,n)===!1)return;var r;e.options.debug&&(r=Date.now()),this.clipboard.records=t.clone(n),this.clipboard.mode="copy";var i=[];t.each(n,function(t){i.push(e._getRecordId(t))}),this.view.copyRecords(i),this._trigger("rows-copied",null,[n]),e.options.debug&&e._trigger("performance-debug",null,{start:r,end:Date.now(),name:"copy-Rows",type:"widget",info:i})}else this._trigger("rows-selected",null,[this.selection.records])}},pasteRows:function(){var e=this;if(this.options.editable){var n=this.clipboard.records;if(n.length){if(this._trigger("before-paste",null,n,this.clipboard.mode)===!1)return;var r=this.focus.record;if(this.clipboard.mode==="cut"){this.store.cutRecords(n,r);var i=[];t.each(n,function(t){i.push(e._getRecordId(t))}),this.view.moveRecords(i,{previousRecord:e._getRecordId(r),waffer:e.store.placeRecord(e.focus.record).waffer}),e.store.moveRecords(this.getSelection(),r),this.clipboard.records=[],this._trigger("cut-rows-pasted",null,[n])}else if(this.clipboard.mode==="copy"){var s=this.store.copyRecords(n,r);this.store.addRecords(s),this._trigger("copied-rows-pasted",null,[s])}}}},_getRecordWaffer:function(e){return this.store.placeRecord(this.store.getRecord(e)).waffer},_pushUndoAction:function(e,t){if(t==null||t)this.redoStack=[];this.undoStack.push(e)},_addRecordToView:function(e,t){t==null&&(t={bulk:!0,location:this.store.placeRecord(e),select:!1});var n=t.location;n==null&&(n=this.store.placeRecord(e)),t.bulk?this.view.populateRecords(this._getRecordId(e),n):this.view.addRecord(this._getRecordId(e),n,t.select,t.bulk)},_updateRow:function(e){var t=this.store.placeRecord(e),n=this.view.makeRow(this._getRecordId(e),t.waffer),r=this.view.buildVirtualRow(this._getRecordId(e),t.waffer);this.view.replaceRow(n,r)},_sortRecords:function(){var e=this,n=e.config.sortBy;n.length?(t.each(e.config.waffers,function(r){var i=e.view.getRecordOrder(r.id),s;e.options.debug&&(s=Date.now()),i.length&&(e.reverseSortOrder?i.reverse():n.length&&i.sort(function(t,r){var i=0;for(var s=0;s<n.length;++s){var o=n[s],u=o.sorter.call(e,e.store.getValueFromRecord(e.store.getRecord(t),o.key),o.order==="asc"),a=o.sorter.call(e,e.store.getValueFromRecord(e.store.getRecord(r),o.key),o.order==="asc");if(u===void 0)return 1;if(a===void 0)return-1;i=u<a?-1:u>a?1:0;if(i!==0)return i}return i}));if(e.options.debug){var o=t.pluck(n,"key");o.splice(0,0,r.id),e._trigger("performance-debug",null,{start:s,end:Date.now(),name:"sort-Records",type:"widget",info:o})}e.view.applySortOrder(r.id,i)}),e.reverseSortOrder=!1):e.view.clearSort(),e.selectCell()},_moveRows:function(e){var n=this,r;n.options.debug&&(r=Date.now());var i=this.store.getRecord(e.previousRecord),s={records:this.getSelection(),afterRecord:i};if(this._trigger("before-move-rows",null,s)===!1)return;var o=[];t.each(this.getSelection(),function(e){o.push(n._getRecordId(e))}),n.view.moveRecords(o,e),n.store.moveRecords(this.getSelection(),i),this._trigger("rows-moved",null,s),n.options.debug&&n._trigger("performance-debug",null,{start:r,end:Date.now(),name:"move-Rows",type:"widget",info:o})},_dropRows:function(e,n){var r=this,i;r.options.debug&&(i=Date.now());var s={records:r.getSelection(),origin:e,dropWaffer:n};if(r._trigger("before-drop-rows",null,s)===!1||n==null)return;var o=[];t.each(this.getSelection(),function(e){o.push(r._getRecordId(e))});var u=this.store.getRecord(t.last(r.view.virtualRows[n].records));r.view.moveRecords(o,{previousRecord:t.last(r.view.virtualRows[n].records),waffer:n}),r.store.moveRecords(this.getSelection(),u),r.selectCell(),r.resize(),r._trigger("rows-dropped",null,s),r.options.debug&&r._trigger("performance-debug",null,{start:i,end:Date.now(),name:"drop-Rows",type:"widget",info:o})},_getRecordAttributes:function(e){var n=this.store.getRecordAttributes(e);return n.selected=t.contains(this.selection.records,e),n.focused=this.focus.record===e,n.copied=this.clipboard.mode==="copy"&&t.contains(this.clipboard.records,e)?!0:!1,n.cut=this.clipboard.mode==="cut"&&t.contains(this.clipboard.records,e)?!0:!1,this.options.selectionMode==="check"&&(n.checked=t.contains(this.checkedRecords,e)),n},_silkFindRecord:function(e,t){var n=this,r=!1;return this.store.iterateStore(function(i){n.store.getValueFromRecord(i,e)===t&&(n.selectCell(n._getRecordId(i)),r=!0)},this),r}})})